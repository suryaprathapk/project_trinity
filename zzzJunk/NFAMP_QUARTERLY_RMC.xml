<PriceType CacheMethodType="CACHE_BITSET" DataCacheMethod="CACHE"
  Description="Quarterly Non-Federal Average Manufacturer Price" Drenabled="false"
  EffectiveEndDate="end_of_time" EffectiveStartDate="start_of_time"
  EffectiveTimezoneID="America/New_York" FilingAgency="VA" FilingPeriod="QTR" LinkedProduct="true"
  ModelAware="true" NetPriceBased="EDIT" NetPriceGroupingRule="LLID|CUST|CONTRACT"
  PluginVersionNumber="2" PriceTypeType="NFAMP_QTR"
  PublishingPlugin="com.modeln.bp.gp.plugins.CMnBasePricePublishingPlugin_V2"
  ReportedResultType="NDC11" ResultsListName="QNFAMP54" RollupToNDC9="false">
  <PriceTypeDataDependency DynamicEntryType="PriceCalcDependency" EndDate="[$PeriodStart] - 1"
    Name="Prior NFAMP Quarterly Dependency" Period="ANN" PeriodOffset="-1" PriceTypeType="NFAMP_QTR"
    StartDate="add_months([$PeriodStart], -9) - 1" WorkbookDependency="false"
    WorksheetName="pqNFAMPs" />
  <PriceTypeDataDependency DynamicEntryType="PriceListDependency" EndDate="[$PeriodEnd]"
    Name="End of Period WAC" Period="QTR" PeriodOffset="0" PriceListType="WAC"
    StartDate="[$PeriodEnd]" WorksheetName="EndPeriodWACList" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="InvoiceDateId" DataSource="W_DIR" DataSourceName="Wholesaler Direct Sales"
    DataSourceType="DIR" Description="Wholesaler Direct Sales"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$W_DIR.StartDate] [$NDC11FirstSalesDateNumTemplate2] W_DIR.item_id)"
    SumWorksheetName="W_DIRSum" WorksheetName="W_DIR" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="InvoiceDateId" DataSource="DIR" DataSourceName="Direct Sales"
    DataSourceType="DIR" Description="All Direct Sales"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$DIR.StartDate] [$NDC11FirstSalesDateNumTemplate2] DIR.item_id)"
    SumWorksheetName="DIRSum" WorksheetName="DIR" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="InvoiceDateId" DataSource="NF_DIR" DataSourceName="Non-Federal Direct Sales"
    DataSourceType="DIR" Description="Non-Federal Direct Sales"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$NF_DIR.StartDate] [$NDC11FirstSalesDateNumTemplate2] NF_DIR.item_id)"
    SumWorksheetName="NF_DIRSum" WorksheetName="NF_DIR" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,DistributorCostAmt,WholesalerNumber,WholesalerName,CustomerNumber,CustomerName,ContractNumber,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="IND" DataSourceName="Indirect Sales"
    DataSourceType="IND" Description="Indirect Sales"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,DistributorCostAmt,WholesalerNumber,WholesalerName,CustomerNumber,CustomerName,CustomerCOT,ContractNumber"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$IND.StartDate] [$NDC11FirstSalesDateNumTemplate2] IND.item_id)"
    SumWorksheetName="INDSum" WorksheetName="IND" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,PaidChgbkAmt,WholesalerNumber,WholesalerName,CustomerNumber,CustomerName,ContractNumber,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="CHB" DataSourceName="Chargebacks"
    DataSourceType="CHB" Description="Chargebacks"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,PaidChgbkAmt,WholesalerNumber,WholesalerName,CustomerNumber,CustomerName,CustomerCOT,ContractNumber"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$CHB.StartDate] [$NDC11FirstSalesDateNumTemplate2] CHB.item_id)"
    SumWorksheetName="CHBSum" WorksheetName="CHB" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,ContractNumber,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="W_REB" DataSourceName="Wholesaler Rebates"
    DataSourceType="REB" Description="Wholesaler Rebates"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ContractNumber"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$W_REB.StartDate] [$NDC11FirstSalesDateNumTemplate2] W_REB.item_id)"
    SumWorksheetName="W_REBSum" WorksheetName="W_REB" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,ContractNumber,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="D_REB" DataSourceName="Direct Rebates"
    DataSourceType="REB" Description="Direct Rebates"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ContractNumber"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$D_REB.StartDate] [$NDC11FirstSalesDateNumTemplate2] D_REB.item_id)"
    SumWorksheetName="D_REBSum" WorksheetName="D_REB" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,ContractNumber,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID,InvDateWACPrice"
    DataSelectionType="PaidDateDimId" DataSource="XW_REB"
    DataSourceName="Excludable Wholesaler Rebates" DataSourceType="REB"
    Description="Excludable Wholesaler Rebates"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ContractNumber,InvDateWACPrice"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$XW_REB.StartDate] [$NDC11FirstSalesDateNumTemplate2] XW_REB.item_id)"
    SumWorksheetName="XW_REBSum" WorksheetName="XW_REB" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,ContractNumber,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID,InvDateWACPrice"
    DataSelectionType="PaidDateDimId" DataSource="XD_REB" DataSourceName="Excludable Direct Rebates"
    DataSourceType="REB" Description="Excludable Direct Rebates"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ContractNumber,InvDateWACPrice"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$XD_REB.StartDate] [$NDC11FirstSalesDateNumTemplate2] XD_REB.item_id)"
    SumWorksheetName="XD_REBSum" WorksheetName="XD_REB" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,FinancialAdjustmentAmount,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="InvoiceDateId" DataSource="W_CUS"
    DataSourceName="Wholesaler Financial Adjustments" DataSourceType="CUS"
    Description="Wholesaler Financial Adjustments"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,FinancialAdjustmentAmount,CustomerNumber,CustomerName,CustomerCOT"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$W_CUS.StartDate] [$NDC11FirstSalesDateNumTemplate2] W_CUS.item_id)"
    SumWorksheetName="W_CUSSum" WorksheetName="W_CUS" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,FinancialAdjustmentAmount,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="InvoiceDateId" DataSource="D_CUS"
    DataSourceName="Direct Financial Adjustments" DataSourceType="CUS"
    Description="Direct Financial Adjustments"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,FinancialAdjustmentAmount,CustomerNumber,CustomerName,CustomerCOT"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="QTR" PeriodOffset="0"
    StartDate="([$NDC11FirstSalesDateNumTemplate1] [$D_CUS.StartDate] [$NDC11FirstSalesDateNumTemplate2] D_CUS.item_id)"
    SumWorksheetName="D_CUSSum" WorksheetName="D_CUS" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="InvoiceDateId" DataSource="DIR_12M" DataSourceName="12 Month Direct Sales"
    DataSourceType="DIR" Description="12 Month All Direct Sales"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="ANN" PeriodOffset="0"
    SumWorksheetName="DIR_12MSum" WorksheetName="DIR_12M" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="InvoiceDateId" DataSource="W_DIR_12M"
    DataSourceName="12 Month Wholesaler Direct Sales" DataSourceType="DIR"
    Description="12 Month Wholesaler Direct Sales"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,PromptPayDiscount,DiscountedTotalInvoiceAmount,CustomerNumber,CustomerName,CustomerCOT"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="ANN" PeriodOffset="0"
    SumWorksheetName="W_DIR_12MSum" WorksheetName="W_DIR_12M" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,DistributorCostAmt,WholesalerNumber,WholesalerName,CustomerNumber,CustomerName,ContractNumber,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="IND_12M" DataSourceName="12 Month Indirect Sales"
    DataSourceType="IND" Description="12 Month Indirect Sales"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,InvoiceDateSql,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,TotalInvoiceAmount,DistributorCostAmt,WholesalerNumber,WholesalerName,CustomerNumber,CustomerName,CustomerCOT,ContractNumber"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="ANN" PeriodOffset="0"
    SumWorksheetName="IND_12MSum" WorksheetName="IND_12M" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,PaidChgbkAmt,WholesalerNumber,WholesalerName,CustomerNumber,CustomerName,ContractNumber,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="CHB_12M" DataSourceName="12 Month Chargebacks"
    DataSourceType="CHB" Description="12 Month Chargebacks"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,InvoiceAmount,PaidChgbkAmt,WholesalerNumber,WholesalerName,CustomerNumber,CustomerName,CustomerCOT,ContractNumber"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="ANN" PeriodOffset="0"
    SumWorksheetName="CHB_12MSum" WorksheetName="CHB_12M" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,ContractNumber,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="XW_REB_12M"
    DataSourceName="12 Month Excludable Wholesaler Rebates" DataSourceType="REB"
    Description="12 Month Excludable Wholesaler Rebates"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ContractNumber"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="ANN" PeriodOffset="0"
    SumWorksheetName="XW_REB_12MSum" WorksheetName="XW_REB_12M" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,ContractNumber,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="XD_REB_12M"
    DataSourceName="12 Month Excludable Direct Rebates" DataSourceType="REB"
    Description="12 Month Excludable Direct Rebates"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ContractNumber"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="ANN" PeriodOffset="0"
    SumWorksheetName="XD_REB_12MSum" WorksheetName="XD_REB_12M" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,ContractNumber,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="WREB1706"
    DataSourceName="12 Month Wholesaler Rebates" DataSourceType="REB" Description="Rebates"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ContractNumber"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="ANN" PeriodOffset="0"
    SumWorksheetName="WREB1706Sum" WorksheetName="WREB1706" />
  <PriceTypeDataDependency Accuracy="ACTUAL"
    CalcBasisColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,ContractNumber,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DataSelectionType="PaidDateDimId" DataSource="REB1707" DataSourceName="12 Month Direct Rebates"
    DataSourceType="REB" Description="Rebates"
    DrilldownColumns="ExternalLineRefId,TransactionTypeCode,ExternalTransactionDate,ExternalPaidDate,ExternalProcessDate,NDCNumber,ProductName,ContractNumber,InvoiceQuantity,InvoiceUOM,RebatePaymentAmt,CustomerNumber,CustomerName,CustomerCOT,ExternalLineLinkID"
    DynamicEntryType="DataSourceConfig" LineLinkIdOverride="NONE" Period="ANN" PeriodOffset="0"
    SumWorksheetName="REB1707Sum" WorksheetName="REB1707" />
  <PriceCalcDef CalcPluginClass="com.modeln.bp.gp.plugins.CMnModelAwareCalcPlugin">
    <NamedExpression Description="Quarterly NFAMP Product Filter" Name="Product Filter">
      <Filter Anded="false" Description="Product Filter Restriction" Enabled="true"
        Expression="&lt;logicalOp name=&quot;or&quot;>&lt;comparisonOp name=&quot;eq&quot;>&lt;attribute direction=&quot;left&quot; name=&quot;EligibleForVA&quot;/>&lt;jdbcPlaceHolderValue direction=&quot;right&quot;>&lt;constant sourceType=&quot;boolean&quot;>false&lt;/constant>&lt;/jdbcPlaceHolderValue>&lt;/comparisonOp>&lt;property name=&quot;dimension&quot;>&lt;value sourceType=&quot;String&quot;>PRODUCT&lt;/value>&lt;/property>&lt;/logicalOp>"
        Handle="Product Filter-821" Inclusionary="false" Name="Product Filter" />
    </NamedExpression>
    <PriceTypeProp Label="Assumed Prompt Pay Discount" Name="AssumedPromptPayDiscount"
      Type="java.lang.Double" Value="0.02" />
    <PriceTypeProp Label="Direct Method Threshold" Name="DirectMethodThreshold"
      Type="java.lang.Double" Value="0.1" />
    <PriceTypeProp Label="Nominal Price Factor" Name="NominalPriceFactor" Type="java.lang.Double"
      Value="0.1" />
    <PriceTypeProp Label="Nominal Filtering" Name="NominalFiltering" NotRequired="true"
      Type="java.lang.Boolean" Value="true" />
    <PriceTypeProp Label="Nominal Price Class of Trade" Name="NominalCOTIDs" NotRequired="true"
      Type="com.modeln.bp.gp.pt.prop.CMnCOTDelimitedListProp" />
    <PriceTypeProp Label="Nominal Price Customer ID" Name="NominalCustomerIDs" NotRequired="true"
      Type="com.modeln.bp.gp.pt.prop.CMnCustomerDelimitedListProp" />
    <PriceCalcRule ModelAware="true" PriceRuleConfig="ERR" PriorityOrderNum="1" ResultType="NDC11"
      RulePluginClass="com.modeln.bp.gp.plugins.CMnModelAwarePriceCalcRulePlugin"
      description="Check for results that are not positive" tag="CalcPriceNotPositive"
      title="NFAMP Not Positive">
      <Condition>or(isblank(NDC11!calcprice), NDC11!calcprice &lt;= 0)</Condition>
    </PriceCalcRule>
    <PriceCalcRule ModelAware="true" PriceRuleConfig="ERR" PriorityOrderNum="2" ResultType="NDC11"
      RulePluginClass="com.modeln.bp.gp.plugins.CMnModelAwarePriceCalcRulePlugin"
      description="Check for results that units are not positive" tag="UnitsNotPositive"
      title="Quantity Not Positive">
      <Condition>or(isblank(NDC11!qty6), NDC11!qty6 &lt;= 0)</Condition>
    </PriceCalcRule>
    <PriceCalcRule ModelAware="true" PriceRuleConfig="ERR" PriorityOrderNum="3" ResultType="NDC11"
      RulePluginClass="com.modeln.bp.gp.plugins.CMnModelAwarePriceCalcRulePlugin"
      description="Check for products that use Direct Method algorithm" tag="DirectMethodUsedRule"
      title="Direct Method Used">
      <Condition>or(NDC11!algorithm = "NFAMPQTR.D", NDC11!algorithm = "NFAMPQTR.FQD",
        NDC11!algorithm = "NFAMP30D.PRV")</Condition>
    </PriceCalcRule>
  </PriceCalcDef>
  <ProductLinkConfig DirectionUsage="NOTUSED" EdgeType="AUTH_GEN" />
  <ProductLinkConfig DirectionUsage="NOTUSED" EdgeType="CUST_PACK" />
  <ProductLinkConfig DirectionUsage="NOTUSED" EdgeType="RELABEL" />
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    description="Data Dependency: NFAMP Quarterly prices for last 4 quarters" name="pqNFAMPs"
    persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id" name="itemId"
      type="itemid">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="amount" displayName="Amount"
      name="amt" type="decimal" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="nextPeriod"
      displayName="Period" name="nextPeriod" type="string" />
    <CalcFilter>in(pqNFAMPs!itemId, NDC11Set!itemId)</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE"
    description="Data Dependency: End of Period WAC price list" name="EndPeriodWACList"
    persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id" name="itemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id" name="origItemId"
      type="integer">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="amount" displayName="Amount"
      name="amt" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" name="ProductFilter"
    persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="item_id" name="itemId"
      type="itemid">
      <Dimension name="itemId" />
    </Column>
    <ParamFilter DynamicEntryType="NamedFilter" generateQuery="true" name="Product Filter" />
    <Query>select distinct itm.item_id
      from mn_item_ver itm
      where itm.item_id in ([SQ:ProductFilter:])
      AND itm.ver_start_date &lt; [$DataCutoff]
      AND itm.ver_end_date &gt;= [$DataCutoff]
      AND [RC:MapItem:itm]</Query>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" name="NominalCustomers"
    persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="member_id" name="custID"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Query>SELECT distinct
      m.member_id
      FROM
      mn_member m
      LEFT OUTER JOIN mn_org_cot_ver cot ON (
      cot.org_id = m.member_id
      )
      WHERE
      cot.ver_start_date &lt; [$DataCutoff] AND
      cot.ver_end_date &gt;= [$DataCutoff] AND
      cot.eff_start_date &lt; [$DataCutoff] AND
      cot.eff_end_date &gt;=[$DataCutoff] AND
      cot.class_of_trade IN ([$NominalCOTIDs])
      UNION
      SELECT distinct m.member_id
      FROM mn_member m
      WHERE m.member_name IN ([$NominalCustomerIDs])</Query>
  </Worksheet>
  <Worksheet DynamicEntryType="SQLWorksheet" name="NominalCustomersList">
    <Query><![CDATA[
              SELECT COUNT( m.member_id) custIdCount
                     FROM mn_member m
                     WHERE m.member_name IN ([$NominalCustomerIDs])
              ]]></Query>
    <Column DynamicEntryType="SQLColumn" name="custIdCount" type="integer" dbColumn="custIdCount">
    </Column>
  </Worksheet>
  <Worksheet DynamicEntryType="SQLWorksheet" name="NominalCotList">
    <Query><![CDATA[
              SELECT COUNT(cot.org_id) cotCount
                     FROM mn_org_cot_ver cot
                     WHERE cot.class_of_trade IN ([$NominalCOTIDs])
              ]]></Query>
    <Column DynamicEntryType="SQLColumn" name="cotCount" type="integer" dbColumn="cotCount">
    </Column>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" name="NetPriceOverride"
    persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="item_id" name="itemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="contracted_cust_id"
      name="custId" type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="ext_contract_id"
      name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="line_link_id"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="period" name="period"
      type="string">
      <Dimension name="period" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="net_price_amt" name="netPrice"
      type="netprice">
      <Dimension name="netPrice" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="override_action" name="action"
      type="resultkind" />
    <Query>SELECT
      COALESCE(o.line_link_id, '-1') AS line_link_id,
      COALESCE(o.contracted_cust_id, -1) AS contracted_cust_id,
      COALESCE(o.ext_contract_id, '-1') AS ext_contract_id,
      COALESCE(o.period, '') AS period,
      o.net_price_amt,
      o.item_id,
      o.override_action
      FROM mn_gp_np_override o
      WHERE o.workbook_id = {workbook.PK, number, #}
      AND [RC:GpNetPriceOverride:o]</Query>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    name="BeginingOfPeriodWACList" persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id" name="itemId"
      type="integer">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="base_price" name="amt"
      type="decimal" />
    <Query>[$PriceListSelect]
      [$PriceListFrom]
      AND mn_struct_line_item_ver.start_date &lt;= [$PeriodStartDateTz]
      AND mn_struct_line_item_ver.end_date &gt;= [$PeriodStartDateTz] )
      [$PriceListWhere]
      AND sdv.struct_doc_type = [$PriceListType]
      AND mn_struct_line_item_ver.start_date &lt;= [$PeriodStartDateTz]
      AND mn_struct_line_item_ver.end_date &gt;= [$PeriodStartDateTz]</Query>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" name="NDC11ProdInformation"
    persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id" name="itemId"
      type="itemid" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id"
      name="originalProdId" type="integer">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id"
      name="linkedItemId" type="integer">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="ndc" name="ndc" type="ndc" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="days_active" name="daysActive"
      type="integer" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="special_item_number"
      displayName="Special Item Number" name="SpecialItemNumber" type="string" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="drug_category"
      description="Drug Category: S, I, N" displayName="Drug Category" name="DrugCategory"
      type="string" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="gnr_brnd_type"
      description="Generic/Brand: GNR, BRND" displayName="Generic/Brand" name="GenericBrandType"
      type="string" />
    <CalcFilter>in(NDC11ProdInformation!originalProdId, ProductFilter!itemId)</CalcFilter>
    <Query>[$NDC11SetSelect],
      mn_item_ver.special_item_number,
      case mn_item_ver.drug_category
      when 1 then 'S'
      when 2 then 'I'
      when 3 then 'N'
      end as drug_category,
      cmf.fld_value as gnr_brnd_type
      [$NDC11SetFrom]
      left outer join mn_cat_map_field_ver cmf on (
      cmf.cat_map_id = base.cat_map_id
      AND cmf.ver_start_date &lt; [$DataCutoff]
      AND cmf.ver_end_date &gt;= [$DataCutoff]
      AND lower(cmf.fld_name) = 'genericbrandtype')
      [$NDC11SetWhere]</Query>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" name="NDC11Set_FQ"
    persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id" name="itemId"
      type="itemid" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id"
      name="originalProdId" type="integer">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id"
      name="linkedItemId" type="integer">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="ndc" name="ndc" type="ndc" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="olderThanYearFlag"
      name="olderThanYearFlag" type="integer" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="isFirstQuarterSetFlag"
      name="isFQFlg" type="integer" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="days_active" name="daysActive"
      type="integer" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="units_conversion"
      name="unitsConversion" type="decimal" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="medicaid_units_per_pack"
      name="MedicaidUnitsPerPack" type="decimal" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="special_item_number"
      displayName="Special Item Number" name="SpecialItemNumber" type="string" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="drug_category"
      description="Drug Category: S, I, N" displayName="Drug Category" name="DrugCategory"
      type="string" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="gnr_brnd_type"
      description="Generic/Brand: GNR, BRND" displayName="Generic/Brand" name="GenericBrandType"
      type="string" />
    <CalcFilter>in(NDC11Set_FQ!originalProdId, ProductFilter!itemId)</CalcFilter>
    <Query>[$NDC11SetSelect],
      1 as isFirstQuarterSetFlag,
      mn_item_ver.special_item_number,
      case mn_item_ver.drug_category
      when 1 then 'S'
      when 2 then 'I'
      when 3 then 'N'
      end as drug_category,
      cmf.fld_value as gnr_brnd_type
      [$NDC11SetFrom]
      left outer join mn_cat_map_field_ver cmf on (
      cmf.cat_map_id = base.cat_map_id
      AND cmf.ver_start_date &lt; [$DataCutoff]
      AND cmf.ver_end_date &gt;= [$DataCutoff]
      AND lower(cmf.fld_name) = 'genericbrandtype')
      [$NDC11SetWhere]
      AND [$FQ_Criteria]</Query>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" name="LinkedNDC11s"
    persisted="true">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="origProdId"
      name="originalProdId" type="integer">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="linkedItemId"
      name="linkedItemId" type="integer">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="wsName" name="worksheetName"
      type="worksheetname" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="units_conversion"
      name="unitsConversion" type="decimal" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="medicaid_units_per_pack"
      name="linkedUnitsPerPack" type="decimal" />
    <ParamFilter DynamicEntryType="NamedFilter" generateQuery="true" name="Product Filter" />
    <CalcFilter>in(LinkedNDC11s!originalProdId ,NDC11Set!originalProdId)</CalcFilter>
    <Query>SELECT A.*, (linkedProd.medicaid_units_per_pack/origProd.medicaid_units_per_pack) as
      units_conversion,
      linkedProd.medicaid_units_per_pack as medicaid_units_per_pack
      FROM ( ${com.modeln.IntermediateResult.query.LinkedNDC11s} ) A,
      mn_gp_product_vw origProd, mn_gp_product_vw linkedProd
      WHERE A.origProdId = origProd.product_id AND
      origProd.model_start_date &lt; [$DataCutoff] AND
      origProd.model_end_date &gt;= [$DataCutoff] AND
      A.linkedItemId = linkedProd.product_id AND
      linkedProd.model_start_date &lt; [$DataCutoff] AND
      linkedProd.model_end_date &gt;= [$DataCutoff]</Query>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" name="WACList"
    persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id" name="itemId"
      type="integer">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="base_price"
      displayName="Amount" name="amt" type="decimal" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="start_date"
      name="start_date_dim" type="decimal" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="end_date" name="end_date_dim"
      type="decimal" />
    <Query>[$PriceListSelect],
      CASE WHEN mn_struct_line_item_ver.start_date &lt; [$PeriodStart]
      THEN (select date_dim_id from mn_date_dim where
      date_num=to_char([$PeriodStartDateTz],'yyyyMMdd'))
      ELSE (select date_dim_id from mn_date_dim where date_num=[$LineStartDim])
      END as start_date,
      CASE WHEN mn_struct_line_item_ver.end_date &gt; [$PeriodEnd]
      THEN (select date_dim_id from mn_date_dim where
      date_num=to_char([$PeriodEndDateTz],'yyyyMMdd') )
      ELSE (select date_dim_id from mn_date_dim where date_num=[$LineEndDim])
      END as end_date
      [$PriceListFrom]
      AND mn_struct_line_item_ver.start_date &lt;= [$PeriodEnd]
      AND mn_struct_line_item_ver.end_date &gt;= [$PeriodStart] )
      [$PriceListWhere]
      AND sdv.struct_doc_type = [$PriceListType]
      AND mn_struct_line_item_ver.start_date &lt;= [$PeriodEnd]
      AND mn_struct_line_item_ver.end_date &gt;= [$PeriodStart]</Query>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="SQLWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" name="NDC11Set_Estab"
    persisted="false">
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id" name="itemId"
      type="itemid" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id"
      name="originalProdId" type="integer">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="cat_obj_id"
      name="linkedItemId" type="integer">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="ndc" name="ndc" type="ndc" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="olderThanYearFlag"
      name="olderThanYearFlag" type="integer" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="isFirstQuarterSetFlag"
      name="isFQFlg" type="integer" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="days_active" name="daysActive"
      type="integer" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="units_conversion"
      name="unitsConversion" type="decimal" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="medicaid_units_per_pack"
      name="MedicaidUnitsPerPack" type="decimal" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="special_item_number"
      displayName="Special Item Number" name="SpecialItemNumber" type="string" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="drug_category"
      description="Drug Category: S, I, N" displayName="Drug Category" name="DrugCategory"
      type="string" />
    <Column DynamicEntryType="SQLColumn" IsInternal="false" dbColumn="gnr_brnd_type"
      description="Generic/Brand: GNR, BRND" displayName="Generic/Brand" name="GenericBrandType"
      type="string" />
    <CalcFilter>in(NDC11Set_Estab!originalProdId, ProductFilter!itemId)</CalcFilter>
    <Query>[$NDC11SetSelect],
      0 as isFirstQuarterSetFlag,
      mn_item_ver.special_item_number,
      case mn_item_ver.drug_category
      when 1 then 'S'
      when 2 then 'I'
      when 3 then 'N'
      end as drug_category,
      cmf.fld_value as gnr_brnd_type
      [$NDC11SetFrom]
      left outer join mn_cat_map_field_ver cmf on (
      cmf.cat_map_id = base.cat_map_id
      AND cmf.ver_start_date &lt; [$DataCutoff]
      AND cmf.ver_end_date &gt;= [$DataCutoff]
      AND lower(cmf.fld_name) = 'genericbrandtype')
      [$NDC11SetWhere]
      AND [$Estab_Criteria]</Query>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="UnionWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" distinct="true"
    name="TransactionSet" persisted="false">
    <SubWorksheet CmsUnits="false" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
      Removable="false" UsageType="NONE" name="DIR_12MLink" persisted="false">
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="itemID" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="linkedItemID" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="externalLineLinkId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="contractId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="custId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="period" type="none" />
    </SubWorksheet>
    <SubWorksheet CmsUnits="false" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
      Removable="false" UsageType="NONE" name="IND_12MLink" persisted="false">
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="itemID" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="linkedItemID" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="externalLineLinkId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="contractId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="custId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="period" type="none" />
    </SubWorksheet>
    <SubWorksheet CmsUnits="false" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
      Removable="false" UsageType="NONE" name="WREB1706Link" persisted="false">
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="itemID" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="linkedItemID" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="externalLineLinkId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="contractId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="custId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="period" type="none" />
    </SubWorksheet>
    <SubWorksheet CmsUnits="false" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
      Removable="false" UsageType="NONE" name="REB1707Link" persisted="false">
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="itemID" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="linkedItemID" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="externalLineLinkId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="contractId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="custId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="period" type="none" />
    </SubWorksheet>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="itemID" type="itemid">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="period" type="string">
      <Dimension name="period" />
      <CoalesceValue>'-1'</CoalesceValue>
    </Column>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="UnionWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE|NET_PRICE"
    displayName="Linked Product Information" distinct="false" name="LinkedNDC11Set"
    persisted="false">
    <SubWorksheet CmsUnits="false" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
      Removable="false" UsageType="NONE" name="NDC11Set" persisted="false">
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="originalProdId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="linkedItemId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="unitsConversion" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="MedicaidUnitsPerPack"
        type="none" />
    </SubWorksheet>
    <SubWorksheet CmsUnits="false" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
      Removable="false" UsageType="NONE" name="LinkedNDC11s" persisted="false">
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="originalProdId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="linkedItemId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="unitsConversion" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="linkedUnitsPerPack" type="none" />
    </SubWorksheet>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" displayName="Original Item Id"
      name="originalProdId" type="integer">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" displayName="Linked Item Id"
      name="linkedItemId" type="integer">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="UnionColumn" IsInternal="false"
      description="Units conversion between linked product and original product"
      displayName="Units Conversion Ratio" name="unitsConversion" type="decimal" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false"
      displayName="Linked CMS Units per Pack" name="linkedUnitsPerPack" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="UnionWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Product Information" distinct="true" name="NDC11Set" persisted="true">
    <SubWorksheet CmsUnits="false" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
      Removable="false" UsageType="NONE" name="NDC11Set_FQ" persisted="false">
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="itemId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="originalProdId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="linkedItemId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="ndc" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="olderThanYearFlag" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="isFQFlg" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="daysActive" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="unitsConversion" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="MedicaidUnitsPerPack"
        type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="SpecialItemNumber" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="DrugCategory" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="GenericBrandType" type="none" />
    </SubWorksheet>
    <SubWorksheet CmsUnits="false" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
      Removable="false" UsageType="NONE" name="NDC11Set_Estab" persisted="false">
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="itemId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="originalProdId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="linkedItemId" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="ndc" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="olderThanYearFlag" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="isFQFlg" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="daysActive" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="unitsConversion" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="MedicaidUnitsPerPack"
        type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="SpecialItemNumber" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="DrugCategory" type="none" />
      <Column DynamicEntryType="SubColumn" IsInternal="false" name="GenericBrandType" type="none" />
    </SubWorksheet>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="itemId" type="itemid" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="originalProdId" type="integer">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="linkedItemId" type="integer">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="UnionColumn" IsInternal="false" displayName="NDC" name="ndc"
      type="ndc" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false"
      description="Indicates that the First Date of Sale is greater than 1 year compared with the workbook calculation end date"
      displayName="Older Than 1 Year Flag" name="olderThanYearFlag" type="integer" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false"
      description="Indicates that the Product life is in the first quarter"
      displayName="First Quarter Flag" name="isFQFlg" type="integer" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="daysActive" type="integer" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false" name="unitsConversion" type="decimal" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false" displayName="CMS Units Per Pack"
      name="MedicaidUnitsPerPack" type="decimal" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false" displayName="Special Item Number"
      name="SpecialItemNumber" type="string" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false" description="Drug Category: S, I, N"
      displayName="Drug Category" name="DrugCategory" type="string" />
    <Column DynamicEntryType="UnionColumn" IsInternal="false" description="Generic/Brand: GNR, BRND"
      displayName="Generic/Brand" name="GenericBrandType" type="string" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    drivingWorksheet="LinkedNDC11Set" name="PriorNFAMPUnion" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Linked Item ID"
      name="linkedItemId" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>pqNFAMPs!amt</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Period" name="nextPeriod"
      type="string">
      <Dimension name="period" />
      <Expr>pqNFAMPs!nextPeriod</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quarter Offset"
      name="quarterOffset" type="integer">
      <Expr>ROW_NUMBER( PARTITION BY LinkedNDC11Set!originalProdId ORDER BY pqNFAMPs!nextPeriod DESC
        )</Expr>
    </Column>
    <CalcFilter>NOT(ISBLANK( pqNFAMPs!amt ))</CalcFilter>
  </Worksheet>
  <Worksheet DynamicEntryType="SQLWorksheet" name="PriorQ3NFAMPUnion"
    description="Data Dependency: NFAMP Quarterly prices for last 4 quarters"
    displayName="Prior Q3 NFAMP Quarterly Dependency" UsageType="FORMULA">
    <Query><![CDATA[
                   SELECT sli.cat_obj_id,
                     sli.base_price AS amount,
                     concat( concat(to_char(add_months(sli.start_date, 3), 'YYYY') , 'Q') ,to_char(add_months(sli.start_date, 3), 'Q')) AS nextPeriod
                   FROM  mn_structured_doc_ver sdv,
                     mn_struct_line_item_ver sli
                   WHERE sdv.ver_start_date < [$DataCutoff]
                   AND sdv.ver_end_date    >= [$DataCutoff]
                   AND ( sdv.prc_doc_status = 'PL.ACTV'
                   OR sdv.prc_doc_status    = 'PL.EXP' )
                   AND sdv.struct_doc_type  = 'NFAMP_QTR'
                   AND sli.struct_doc_id    =sdv.struct_doc_id
                   AND sli.ver_num         <= sdv.ver_num
                   AND sli.end_ver_num      > sdv.ver_num
                   AND sli.start_date      <=  ( CASE
                       	WHEN [$PeriodEnd] = to_date( concat([$WbYear] , '-12-31'), 'YYYY-MM-DD')
                           THEN to_date( concat([$WbYear]   , '-09-30'),'YYYY-MM-DD')
                           ELSE to_date( concat([$WbYear]-1 , '-09-30'),'YYYY-MM-DD')
                       END
                        )
                   AND sli.end_date        >= ( CASE
                       	WHEN [$PeriodEnd] = to_date( concat([$WbYear] , '-12-31'), 'YYYY-MM-DD')
             				THEN to_date( concat([$WbYear]   , '-09-30'),'YYYY-MM-DD')
             			ELSE to_date( concat([$WbYear]-1 , '-09-30'),'YYYY-MM-DD')
                  END
                   )]]></Query>
    <Column DynamicEntryType="SQLColumn" name="itemId" type="itemid" dbColumn="cat_obj_id">
      <Dimension name="itemId" />
    </Column>
    <Column DynamicEntryType="SQLColumn" name="amt" displayName="Amount" type="decimal"
      dbColumn="amount" />
    <Column DynamicEntryType="SQLColumn" name="nextPeriod" dbColumn="nextPeriod"
      displayName="Period" type="string" />
    <CalcFilter><![CDATA[in(PriorQ3NFAMPUnion!itemId, NDC11Set!itemId)]]></CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    drivingWorksheet="PriorNFAMPUnion" name="pq1NFAMP" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="itemid">
      <Dimension name="itemId" />
      <Expr>PriorNFAMPUnion!itemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>MAX(PriorNFAMPUnion!amt)</Expr>
    </Column>
    <GroupingExpression>PriorNFAMPUnion!itemId</GroupingExpression>
    <CalcFilter>PriorNFAMPUnion!quarterOffset = 1</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Maximum End Of Period WAC" drivingWorksheet="EndPeriodWACList"
    name="MaxEndPeriodWAC" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="integer">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount Per Unit"
      name="amt" type="decimal">
      <Expr>MAX( if( NDC11Set!MedicaidUnitsPerPack != 0, EndPeriodWACList!amt /
        NDC11Set!MedicaidUnitsPerPack ) )</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE|VALIDATION"
    description="Data Dependency: Begining Of Period WAC price" displayName="Begining Of Period WAC"
    drivingWorksheet="BeginingOfPeriodWACList" name="BOPWAC" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>BeginingOfPeriodWACList!itemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>max(BeginingOfPeriodWACList!amt)</Expr>
    </Column>
    <GroupingExpression>BeginingOfPeriodWACList!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE|VALIDATION"
    description="Data Dependency: Weighted Average WAC price" displayName="Weighted Average WAC"
    drivingWorksheet="WACList" name="DollarWWAC" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>WACList!itemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(WACList!amt*(WACList!end_date_dim - WACList!start_date_dim + 1))
        /
        if( ( max(NDC11Set!daysActive) &lt; ([$PeriodEndDateTz]-[$PeriodStartDateTz]) ),
        max(NDC11Set!daysActive),
        ([$PeriodEndDateTz]-[$PeriodStartDateTz]+1) )</Expr>
    </Column>
    <GroupingExpression>WACList!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Maximum Weighted Average WAC" drivingWorksheet="DollarWWAC" name="MaxDollarWWAC"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="integer">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount Per Unit"
      name="amt" type="decimal">
      <Expr>MAX( if( NDC11Set!MedicaidUnitsPerPack != 0, DollarWWAC!amt /
        NDC11Set!MedicaidUnitsPerPack ) )</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Maximum Begining Of Period WAC" drivingWorksheet="BOPWAC" name="MaxBOPWAC"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="integer">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount Per Unit"
      name="amt" type="decimal">
      <Expr>MAX( if( NDC11Set!MedicaidUnitsPerPack != 0, BOPWAC!amt / NDC11Set!MedicaidUnitsPerPack
        ) )</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE|VALIDATION"
    description="Data Dependency: Minimum WAC price" displayName="Minimum WAC"
    drivingWorksheet="WACList" name="minWAC" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>WACList!itemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>min(WACList!amt)</Expr>
    </Column>
    <GroupingExpression>WACList!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE"
    description="Product Information" displayName="Product Information"
    drivingWorksheet="NDC11ProdInformation" name="ProductInformation" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="integer">
      <Dimension name="itemId" />
      <Expr>NDC11ProdInformation!itemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Special Item Number"
      name="SpecialItemNumber" type="string">
      <Expr>max(NDC11ProdInformation!SpecialItemNumber)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Drug Category: S, I, N"
      displayName="Drug Category" name="DrugCategory" type="string">
      <Expr>max(NDC11ProdInformation!DrugCategory)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Generic/Brand: GNR, BRND"
      displayName="Generic/Brand" name="GenericBrandType" type="string">
      <Expr>max(NDC11ProdInformation!GenericBrandType)</Expr>
    </Column>
    <GroupingExpression>NDC11ProdInformation!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Minimum WAC " drivingWorksheet="minWAC" name="MinWACList" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="integer">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount Per Unit"
      name="amt" type="decimal">
      <Expr>MIN( if( NDC11Set!MedicaidUnitsPerPack != 0, minWAC!amt / NDC11Set!MedicaidUnitsPerPack
        ) )</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA" drivingWorksheet="W_DIR"
    name="W_DIRSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(W_DIR!TotalInvoiceAmount*(1-W_DIR!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(W_DIR!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Wholesaler Direct Sales Aggregate Data" drivingWorksheet="W_DIR" name="W_DIRLink"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(W_DIR!TotalInvoiceAmount*(1-W_DIR!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(W_DIR!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>W_DIR!externalLineLinkId</GroupingExpression>
    <GroupingExpression>W_DIR!custId</GroupingExpression>
    <GroupingExpression>W_DIR!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA" drivingWorksheet="DIR"
    name="DIRSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(DIR!TotalInvoiceAmount*(1-DIR!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(DIR!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Direct Sales Aggregate Data" drivingWorksheet="DIR" name="DIRLink"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(DIR!TotalInvoiceAmount*(1-DIR!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(DIR!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>DIR!externalLineLinkId</GroupingExpression>
    <GroupingExpression>DIR!custId</GroupingExpression>
    <GroupingExpression>DIR!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="NF_DIR" name="NF_DIRSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(NF_DIR!TotalInvoiceAmount*(1 - NF_DIR!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(NF_DIR!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Non-Federal Direct Sales Aggregate Data" drivingWorksheet="NF_DIR"
    name="NF_DIRLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(NF_DIR!TotalInvoiceAmount*(1 - NF_DIR!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(NF_DIR!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>NF_DIR!externalLineLinkId</GroupingExpression>
    <GroupingExpression>NF_DIR!custId</GroupingExpression>
    <GroupingExpression>NF_DIR!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA" drivingWorksheet="IND"
    name="INDSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>(1-[$AssumedPromptPayDiscount]) * sum( EndPeriodWACList!amt * IND!InvoiceQuantity)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(IND!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Indirect Sales Aggregate Data" drivingWorksheet="IND" name="INDLink"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>(1-[$AssumedPromptPayDiscount]) * sum( EndPeriodWACList!amt * IND!InvoiceQuantity)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(IND!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>IND!externalLineLinkId</GroupingExpression>
    <GroupingExpression>IND!custId</GroupingExpression>
    <GroupingExpression>IND!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA" drivingWorksheet="CHB"
    name="CHBSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(CHB!PaidChgbkAmt)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Chargebacks Aggregate Data" drivingWorksheet="CHB" name="CHBLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(CHB!PaidChgbkAmt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>NULL</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>CHB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>CHB!custId</GroupingExpression>
    <GroupingExpression>CHB!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA" drivingWorksheet="W_REB"
    name="W_REBSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(W_REB!RebatePaymentAmt)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Wholesaler Rebates Aggregate Data" drivingWorksheet="W_REB" name="W_REBLink"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(W_REB!RebatePaymentAmt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>NULL</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>W_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>W_REB!custId</GroupingExpression>
    <GroupingExpression>W_REB!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="W_REB"
    name="UnqCountW_REB" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Orig Ref Num"
      name="OrigRefNum" type="integer">
      <Expr>W_REB!OrigRefNum</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>W_REB!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="lineCount" type="integer">
      <Expr>count(1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>W_REB!externalLineLinkId</Expr>
    </Column>
    <GroupingExpression>W_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>W_REB!OrigRefNum</GroupingExpression>
    <GroupingExpression>W_REB!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="W_REB"
    name="UnqW_REB" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="linkedItemId" />
      <Expr>W_REB!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(W_REB!InvoiceQuantity/UnqCountW_REB!lineCount)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(W_REB!RebatePaymentAmt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>W_REB!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>W_REB!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>W_REB!contractId</Expr>
    </Column>
    <GroupingExpression>W_REB!itemId</GroupingExpression>
    <GroupingExpression>W_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>W_REB!custId</GroupingExpression>
    <GroupingExpression>W_REB!contractId</GroupingExpression>
    <GroupingExpression>W_REB!origRefNum</GroupingExpression>
    <CalcFilter>in( W_REB!ItemId , LinkedNDC11Set!originalProdId )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountW_REB!externalLineLinkId ), ISBLANK(
      W_REB!externalLineLinkId ) ), ( UnqCountW_REB!externalLineLinkId = W_REB!externalLineLinkId )
      )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountW_REB!OrigRefNum ), ISBLANK( W_REB!OrigRefNum ) ), (
      UnqCountW_REB!OrigRefNum = W_REB!OrigRefNum ) )</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Sum of Uniqued Wholesaler Rebates" drivingWorksheet="UnqW_REB" name="UnqW_REBSum"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqW_REB!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqW_REB!qty)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Uniqued Wholesaler Rebates Aggregate Data" drivingWorksheet="UnqW_REB"
    name="UnqW_REBLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqW_REB!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqW_REB!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>UnqW_REB!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>UnqW_REB!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>UnqW_REB!contractId</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>UnqW_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>UnqW_REB!custId</GroupingExpression>
    <GroupingExpression>UnqW_REB!contractId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA" drivingWorksheet="D_REB"
    name="D_REBSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(D_REB!RebatePaymentAmt)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Direct Rebates Aggregate Data" drivingWorksheet="D_REB" name="D_REBLink"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(D_REB!RebatePaymentAmt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>NULL</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>D_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>D_REB!custId</GroupingExpression>
    <GroupingExpression>D_REB!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="D_REB"
    name="UnqCountD_REB" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Orig Ref Num"
      name="OrigRefNum" type="integer">
      <Expr>D_REB!OrigRefNum</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>D_REB!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="lineCount" type="integer">
      <Expr>count(1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>D_REB!externalLineLinkId</Expr>
    </Column>
    <GroupingExpression>D_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>D_REB!OrigRefNum</GroupingExpression>
    <GroupingExpression>D_REB!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="D_REB"
    name="UnqD_REB" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="linkedItemId" />
      <Expr>D_REB!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(D_REB!InvoiceQuantity/UnqCountD_REB!lineCount)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(D_REB!RebatePaymentAmt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>D_REB!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>D_REB!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>D_REB!contractId</Expr>
    </Column>
    <GroupingExpression>D_REB!itemId</GroupingExpression>
    <GroupingExpression>D_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>D_REB!custId</GroupingExpression>
    <GroupingExpression>D_REB!contractId</GroupingExpression>
    <GroupingExpression>D_REB!origRefNum</GroupingExpression>
    <CalcFilter>in( D_REB!ItemId , LinkedNDC11Set!originalProdId )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountD_REB!externalLineLinkId ), ISBLANK(
      D_REB!externalLineLinkId ) ), ( UnqCountD_REB!externalLineLinkId = D_REB!externalLineLinkId )
      )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountD_REB!OrigRefNum ), ISBLANK( D_REB!OrigRefNum ) ), (
      UnqCountD_REB!OrigRefNum = D_REB!OrigRefNum ) )</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Sum of Uniqued Direct Rebates" drivingWorksheet="UnqD_REB" name="UnqD_REBSum"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqD_REB!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqD_REB!qty)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Uniqued Direct Rebates Aggregate Data" drivingWorksheet="UnqD_REB"
    name="UnqD_REBLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqD_REB!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqD_REB!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>UnqD_REB!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>UnqD_REB!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>UnqD_REB!contractId</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>UnqD_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>UnqD_REB!custId</GroupingExpression>
    <GroupingExpression>UnqD_REB!contractId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="XW_REB" name="XW_REBSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum ( XW_REB!InvDateWACPrice * XW_REB!InvoiceQuantity ) * ( 1 -
        [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(XW_REB!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Excludable Wholesaler Rebates Aggregate Data" drivingWorksheet="XW_REB"
    name="XW_REBLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum ( XW_REB!InvDateWACPrice * XW_REB!InvoiceQuantity ) * ( 1 -
        [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(XW_REB!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>XW_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XW_REB!custId</GroupingExpression>
    <GroupingExpression>XW_REB!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="XW_REB"
    name="UnqCountXW_REB" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Orig Ref Num"
      name="OrigRefNum" type="integer">
      <Expr>XW_REB!OrigRefNum</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>XW_REB!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="lineCount" type="integer">
      <Expr>count(1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XW_REB!externalLineLinkId</Expr>
    </Column>
    <GroupingExpression>XW_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XW_REB!OrigRefNum</GroupingExpression>
    <GroupingExpression>XW_REB!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="XW_REB"
    name="UnqXW_REB" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="linkedItemId" />
      <Expr>XW_REB!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum((XW_REB!InvoiceQuantity/UnqCountXW_REB!lineCount) * 1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum ( XW_REB!InvDateWACPrice * (XW_REB!InvoiceQuantity/UnqCountXW_REB!lineCount) ) * ( 1
        - [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XW_REB!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>XW_REB!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>XW_REB!contractId</Expr>
    </Column>
    <GroupingExpression>XW_REB!itemId</GroupingExpression>
    <GroupingExpression>XW_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XW_REB!custId</GroupingExpression>
    <GroupingExpression>XW_REB!contractId</GroupingExpression>
    <GroupingExpression>XW_REB!origRefNum</GroupingExpression>
    <CalcFilter>in( XW_REB!ItemId , LinkedNDC11Set!originalProdId )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountXW_REB!externalLineLinkId ), ISBLANK(
      XW_REB!externalLineLinkId ) ), ( UnqCountXW_REB!externalLineLinkId = XW_REB!externalLineLinkId
      ) )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountXW_REB!OrigRefNum ), ISBLANK( XW_REB!OrigRefNum ) ), (
      UnqCountXW_REB!OrigRefNum = XW_REB!OrigRefNum ) )</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Sum of Uniqued Excludable Wholesaler Rebates" drivingWorksheet="UnqXW_REB"
    name="UnqXW_REBSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqXW_REB!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqXW_REB!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Uniqued Excludable Wholesaler Rebates Aggregate Data" drivingWorksheet="UnqXW_REB"
    name="UnqXW_REBLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqXW_REB!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqXW_REB!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>UnqXW_REB!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>UnqXW_REB!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>UnqXW_REB!contractId</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>UnqXW_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>UnqXW_REB!custId</GroupingExpression>
    <GroupingExpression>UnqXW_REB!contractId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="XD_REB" name="XD_REBSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum ( XD_REB!InvDateWACPrice * XD_REB!InvoiceQuantity ) * ( 1 -
        [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(XD_REB!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Excludable Direct Rebates Aggregate Data" drivingWorksheet="XD_REB"
    name="XD_REBLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum ( XD_REB!InvDateWACPrice * XD_REB!InvoiceQuantity ) * ( 1 -
        [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(XD_REB!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>XD_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XD_REB!custId</GroupingExpression>
    <GroupingExpression>XD_REB!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="XD_REB"
    name="UnqCountXD_REB" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Orig Ref Num"
      name="OrigRefNum" type="integer">
      <Expr>XD_REB!OrigRefNum</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>XD_REB!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="lineCount" type="integer">
      <Expr>count(1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XD_REB!externalLineLinkId</Expr>
    </Column>
    <GroupingExpression>XD_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XD_REB!OrigRefNum</GroupingExpression>
    <GroupingExpression>XD_REB!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="XD_REB"
    name="UnqXD_REB" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="linkedItemId" />
      <Expr>XD_REB!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum((XD_REB!InvoiceQuantity/UnqCountXD_REB!lineCount) * 1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum ( XD_REB!InvDateWACPrice * (XD_REB!InvoiceQuantity/UnqCountXD_REB!lineCount) ) * ( 1
        - [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XD_REB!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>XD_REB!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>XD_REB!contractId</Expr>
    </Column>
    <GroupingExpression>XD_REB!itemId</GroupingExpression>
    <GroupingExpression>XD_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XD_REB!custId</GroupingExpression>
    <GroupingExpression>XD_REB!contractId</GroupingExpression>
    <GroupingExpression>XD_REB!origRefNum</GroupingExpression>
    <CalcFilter>in( XD_REB!ItemId , LinkedNDC11Set!originalProdId )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountXD_REB!externalLineLinkId ), ISBLANK(
      XD_REB!externalLineLinkId ) ), ( UnqCountXD_REB!externalLineLinkId = XD_REB!externalLineLinkId
      ) )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountXD_REB!OrigRefNum ), ISBLANK( XD_REB!OrigRefNum ) ), (
      UnqCountXD_REB!OrigRefNum = XD_REB!OrigRefNum ) )</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Sum of Uniqued Excludable Direct Rebates" drivingWorksheet="UnqXD_REB"
    name="UnqXD_REBSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqXD_REB!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqXD_REB!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Uniqued Excludable Direct Rebates Aggregate Data" drivingWorksheet="UnqXD_REB"
    name="UnqXD_REBLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqXD_REB!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqXD_REB!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>UnqXD_REB!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>UnqXD_REB!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>UnqXD_REB!contractId</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>UnqXD_REB!externalLineLinkId</GroupingExpression>
    <GroupingExpression>UnqXD_REB!custId</GroupingExpression>
    <GroupingExpression>UnqXD_REB!contractId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA" drivingWorksheet="W_CUS"
    name="W_CUSSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(W_CUS!FinancialAdjustmentAmount)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Wholesaler Financial Adjustments Aggregate Data" drivingWorksheet="W_CUS"
    name="W_CUSLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(W_CUS!FinancialAdjustmentAmount)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>NULL</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>W_CUS!externalLineLinkId</GroupingExpression>
    <GroupingExpression>W_CUS!custId</GroupingExpression>
    <GroupingExpression>W_CUS!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA" drivingWorksheet="D_CUS"
    name="D_CUSSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(D_CUS!FinancialAdjustmentAmount)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Direct Financial Adjustments Aggregate Data" drivingWorksheet="D_CUS"
    name="D_CUSLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(D_CUS!FinancialAdjustmentAmount)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>NULL</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>D_CUS!externalLineLinkId</GroupingExpression>
    <GroupingExpression>D_CUS!custId</GroupingExpression>
    <GroupingExpression>D_CUS!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="DIR_12M" name="DIR_12MSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(DIR_12M!TotalInvoiceAmount*(1 - DIR_12M!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(DIR_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="12 Month Direct Sales Aggregate Data" drivingWorksheet="DIR_12M" name="DIR_12MLink"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Period"
      displayName="Period" name="period" type="string">
      <Dimension name="period" />
      <Expr>tostring( DIR_12M!selDate, "YYYY" ) || "Q" || tostring( DIR_12M!selDate, "Q" )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(DIR_12M!TotalInvoiceAmount*(1 - DIR_12M!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(DIR_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>DIR_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Customer" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <Expr>DIR_12M!custId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Contract" name="contractId"
      type="extcontractid">
      <Dimension name="contractId" />
      <Expr>DIR_12M!contractId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <GroupingExpression>tostring( DIR_12M!selDate, "YYYY" ) || "Q" || tostring( DIR_12M!selDate, "Q"
      )</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>DIR_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>DIR_12M!custId</GroupingExpression>
    <GroupingExpression>DIR_12M!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="W_DIR_12M" name="W_DIR_12MSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(W_DIR_12M!TotalInvoiceAmount*(1-W_DIR_12M!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(W_DIR_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="12 Month Wholesaler Direct Sales Aggregate Data" drivingWorksheet="W_DIR_12M"
    name="W_DIR_12MLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Period"
      displayName="Period" name="period" type="string">
      <Dimension name="period" />
      <Expr>tostring( W_DIR_12M!selDate, "YYYY" ) || "Q" || tostring( W_DIR_12M!selDate, "Q" )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(W_DIR_12M!TotalInvoiceAmount*(1-W_DIR_12M!PromptPayDiscount))</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(W_DIR_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>W_DIR_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Customer" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <Expr>W_DIR_12M!custId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Contract" name="contractId"
      type="extcontractid">
      <Dimension name="contractId" />
      <Expr>W_DIR_12M!contractId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <GroupingExpression>tostring( W_DIR_12M!selDate, "YYYY" ) || "Q" || tostring( W_DIR_12M!selDate,
      "Q" )</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>W_DIR_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>W_DIR_12M!custId</GroupingExpression>
    <GroupingExpression>W_DIR_12M!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="IND_12M" name="IND_12MSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>(1-[$AssumedPromptPayDiscount]) * sum( EndPeriodWACList!amt * IND_12M!InvoiceQuantity)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(IND_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="12 Month Indirect Sales Aggregate Data" drivingWorksheet="IND_12M"
    name="IND_12MLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Period"
      displayName="Period" name="period" type="string">
      <Dimension name="period" />
      <Expr>tostring( IND_12M!selDate, "YYYY" ) || "Q" || tostring( IND_12M!selDate, "Q" )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>(1-[$AssumedPromptPayDiscount]) * sum( EndPeriodWACList!amt * IND_12M!InvoiceQuantity)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(IND_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>IND_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Customer" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <Expr>IND_12M!custId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Contract" name="contractId"
      type="extcontractid">
      <Dimension name="contractId" />
      <Expr>IND_12M!contractId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <GroupingExpression>tostring( IND_12M!selDate, "YYYY" ) || "Q" || tostring( IND_12M!selDate, "Q"
      )</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>IND_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>IND_12M!custId</GroupingExpression>
    <GroupingExpression>IND_12M!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="CHB_12M" name="CHB_12MSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(CHB_12M!PaidChgbkAmt)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="12 Month Chargebacks Aggregate Data" drivingWorksheet="CHB_12M" name="CHB_12MLink"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Period"
      displayName="Period" name="period" type="string">
      <Dimension name="period" />
      <Expr>tostring( CHB_12M!selDate, "YYYY" ) || "Q" || tostring( CHB_12M!selDate, "Q" )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>sum(CHB_12M!PaidChgbkAmt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>NULL</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>CHB_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Customer" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <Expr>CHB_12M!custId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Contract" name="contractId"
      type="extcontractid">
      <Dimension name="contractId" />
      <Expr>CHB_12M!contractId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <GroupingExpression>tostring( CHB_12M!selDate, "YYYY" ) || "Q" || tostring( CHB_12M!selDate, "Q"
      )</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>CHB_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>CHB_12M!custId</GroupingExpression>
    <GroupingExpression>CHB_12M!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="cbAmt"
      type="decimal">
      <Expr>SUM( CHB_12M!PaidChgbkAmt )</Expr>
    </Column>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="XW_REB_12M" name="XW_REB_12MSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>SUM ( XW_REB_12M!InvoiceQuantity * XW_REB_12M!InvDateWACPrice ) * ( 1 -
        [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(XW_REB_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="12 Month Excludable Wholesaler Rebates Aggregate Data"
    drivingWorksheet="XW_REB_12M" name="XW_REB_12MLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Period"
      displayName="Period" name="period" type="string">
      <Dimension name="period" />
      <Expr>tostring( XW_REB_12M!selDate, "YYYY" ) || "Q" || tostring( XW_REB_12M!selDate, "Q" )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>SUM ( XW_REB_12M!InvoiceQuantity * XW_REB_12M!InvDateWACPrice ) * ( 1 -
        [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(XW_REB_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XW_REB_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Customer" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <Expr>XW_REB_12M!custId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Contract" name="contractId"
      type="extcontractid">
      <Dimension name="contractId" />
      <Expr>XW_REB_12M!contractId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <GroupingExpression>tostring( XW_REB_12M!selDate, "YYYY" ) || "Q" || tostring(
      XW_REB_12M!selDate, "Q" )</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>XW_REB_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XW_REB_12M!custId</GroupingExpression>
    <GroupingExpression>XW_REB_12M!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    drivingWorksheet="XW_REB_12M" name="UnqCountXW_REB_12M" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Orig Ref Num"
      name="OrigRefNum" type="integer">
      <Expr>XW_REB_12M!OrigRefNum</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>XW_REB_12M!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="lineCount" type="integer">
      <Expr>count(1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XW_REB_12M!externalLineLinkId</Expr>
    </Column>
    <GroupingExpression>XW_REB_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XW_REB_12M!OrigRefNum</GroupingExpression>
    <GroupingExpression>XW_REB_12M!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    drivingWorksheet="XW_REB_12M" name="UnqXW_REB_12M" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="linkedItemId" />
      <Expr>XW_REB_12M!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum((XW_REB_12M!InvoiceQuantity/UnqCountXW_REB_12M!lineCount) * 1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>SUM ( (XW_REB_12M!InvoiceQuantity/UnqCountXW_REB_12M!lineCount) *
        XW_REB_12M!InvDateWACPrice ) * ( 1 - [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XW_REB_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>XW_REB_12M!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>XW_REB_12M!contractId</Expr>
    </Column>
    <GroupingExpression>XW_REB_12M!itemId</GroupingExpression>
    <GroupingExpression>XW_REB_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XW_REB_12M!custId</GroupingExpression>
    <GroupingExpression>XW_REB_12M!contractId</GroupingExpression>
    <GroupingExpression>XW_REB_12M!origRefNum</GroupingExpression>
    <CalcFilter>in( XW_REB_12M!ItemId , LinkedNDC11Set!originalProdId )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountXW_REB_12M!externalLineLinkId ), ISBLANK(
      XW_REB_12M!externalLineLinkId ) ), ( UnqCountXW_REB_12M!externalLineLinkId =
      XW_REB_12M!externalLineLinkId ) )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountXW_REB_12M!OrigRefNum ), ISBLANK( XW_REB_12M!OrigRefNum )
      ), ( UnqCountXW_REB_12M!OrigRefNum = XW_REB_12M!OrigRefNum ) )</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Sum of Uniqued 12 Month Excludable Wholesaler Rebates"
    drivingWorksheet="UnqXW_REB_12M" name="UnqXW_REB_12MSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqXW_REB_12M!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqXW_REB_12M!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Uniqued 12 Month Excludable Wholesaler Rebates Aggregate Data"
    drivingWorksheet="UnqXW_REB_12M" name="UnqXW_REB_12MLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqXW_REB_12M!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqXW_REB_12M!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>UnqXW_REB_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>UnqXW_REB_12M!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>UnqXW_REB_12M!contractId</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>UnqXW_REB_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>UnqXW_REB_12M!custId</GroupingExpression>
    <GroupingExpression>UnqXW_REB_12M!contractId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="XD_REB_12M" name="XD_REB_12MSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>SUM ( XD_REB_12M!InvoiceQuantity * XD_REB_12M!InvDateWACPrice ) * ( 1 -
        [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by product"
      displayName="Quantity" name="inv_qty" type="decimal">
      <Expr>sum(XD_REB_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="12 Month Excludable Direct Rebates Aggregate Data" drivingWorksheet="XD_REB_12M"
    name="XD_REB_12MLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Period"
      displayName="Period" name="period" type="string">
      <Dimension name="period" />
      <Expr>tostring( XD_REB_12M!selDate, "YYYY" ) || "Q" || tostring( XD_REB_12M!selDate, "Q" )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>SUM ( XD_REB_12M!InvoiceQuantity * XD_REB_12M!InvDateWACPrice ) * ( 1 -
        [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>sum(XD_REB_12M!InvoiceQuantity * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XD_REB_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Customer" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <Expr>XD_REB_12M!custId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Contract" name="contractId"
      type="extcontractid">
      <Dimension name="contractId" />
      <Expr>XD_REB_12M!contractId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <GroupingExpression>tostring( XD_REB_12M!selDate, "YYYY" ) || "Q" || tostring(
      XD_REB_12M!selDate, "Q" )</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>XD_REB_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XD_REB_12M!custId</GroupingExpression>
    <GroupingExpression>XD_REB_12M!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    drivingWorksheet="XD_REB_12M" name="UnqCountXD_REB_12M" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Orig Ref Num"
      name="OrigRefNum" type="integer">
      <Expr>XD_REB_12M!OrigRefNum</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>XD_REB_12M!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="lineCount" type="integer">
      <Expr>count(1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XD_REB_12M!externalLineLinkId</Expr>
    </Column>
    <GroupingExpression>XD_REB_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XD_REB_12M!OrigRefNum</GroupingExpression>
    <GroupingExpression>XD_REB_12M!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    drivingWorksheet="XD_REB_12M" name="UnqXD_REB_12M" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="linkedItemId" />
      <Expr>XD_REB_12M!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum((XD_REB_12M!InvoiceQuantity/UnqCountXD_REB_12M!lineCount) * 1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>SUM ( (XD_REB_12M!InvoiceQuantity/UnqCountXD_REB_12M!lineCount) *
        XD_REB_12M!InvDateWACPrice ) * ( 1 - [$AssumedPromptPayDiscount] )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>XD_REB_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>XD_REB_12M!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>XD_REB_12M!contractId</Expr>
    </Column>
    <GroupingExpression>XD_REB_12M!itemId</GroupingExpression>
    <GroupingExpression>XD_REB_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>XD_REB_12M!custId</GroupingExpression>
    <GroupingExpression>XD_REB_12M!contractId</GroupingExpression>
    <GroupingExpression>XD_REB_12M!origRefNum</GroupingExpression>
    <CalcFilter>in( XD_REB_12M!ItemId , LinkedNDC11Set!originalProdId )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountXD_REB_12M!externalLineLinkId ), ISBLANK(
      XD_REB_12M!externalLineLinkId ) ), ( UnqCountXD_REB_12M!externalLineLinkId =
      XD_REB_12M!externalLineLinkId ) )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountXD_REB_12M!OrigRefNum ), ISBLANK( XD_REB_12M!OrigRefNum )
      ), ( UnqCountXD_REB_12M!OrigRefNum = XD_REB_12M!OrigRefNum ) )</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Sum of Uniqued 12 Month Excludable Direct Rebates" drivingWorksheet="UnqXD_REB_12M"
    name="UnqXD_REB_12MSum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqXD_REB_12M!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqXD_REB_12M!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Uniqued 12 Month Excludable Direct Rebates Aggregate Data"
    drivingWorksheet="UnqXD_REB_12M" name="UnqXD_REB_12MLink" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqXD_REB_12M!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqXD_REB_12M!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>UnqXD_REB_12M!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>UnqXD_REB_12M!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>UnqXD_REB_12M!contractId</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>UnqXD_REB_12M!externalLineLinkId</GroupingExpression>
    <GroupingExpression>UnqXD_REB_12M!custId</GroupingExpression>
    <GroupingExpression>UnqXD_REB_12M!contractId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="WREB1706" name="WREB1706Sum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>SUM ( WREB1706!RebatePaymentAmt )</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="12 Month Wholesaler Rebates Aggregate Data" drivingWorksheet="WREB1706"
    name="WREB1706Link" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Period"
      displayName="Period" name="period" type="string">
      <Dimension name="period" />
      <Expr>tostring( WREB1706!selDate, "YYYY" ) || "Q" || tostring( WREB1706!selDate, "Q" )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>SUM ( WREB1706!RebatePaymentAmt )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>NULL</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>WREB1706!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Customer" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <Expr>WREB1706!custId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Contract" name="contractId"
      type="extcontractid">
      <Dimension name="contractId" />
      <Expr>WREB1706!contractId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <GroupingExpression>tostring( WREB1706!selDate, "YYYY" ) || "Q" || tostring( WREB1706!selDate,
      "Q" )</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>WREB1706!externalLineLinkId</GroupingExpression>
    <GroupingExpression>WREB1706!custId</GroupingExpression>
    <GroupingExpression>WREB1706!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="WREB1706"
    name="UnqCountWREB1706" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Orig Ref Num"
      name="OrigRefNum" type="integer">
      <Expr>WREB1706!OrigRefNum</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>WREB1706!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="lineCount" type="integer">
      <Expr>count(1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>WREB1706!externalLineLinkId</Expr>
    </Column>
    <GroupingExpression>WREB1706!externalLineLinkId</GroupingExpression>
    <GroupingExpression>WREB1706!OrigRefNum</GroupingExpression>
    <GroupingExpression>WREB1706!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="WREB1706"
    name="UnqWREB1706" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="linkedItemId" />
      <Expr>WREB1706!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(WREB1706!InvoiceQuantity/UnqCountWREB1706!lineCount)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>SUM ( WREB1706!RebatePaymentAmt )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>WREB1706!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>WREB1706!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>WREB1706!contractId</Expr>
    </Column>
    <GroupingExpression>WREB1706!itemId</GroupingExpression>
    <GroupingExpression>WREB1706!externalLineLinkId</GroupingExpression>
    <GroupingExpression>WREB1706!custId</GroupingExpression>
    <GroupingExpression>WREB1706!contractId</GroupingExpression>
    <GroupingExpression>WREB1706!origRefNum</GroupingExpression>
    <CalcFilter>in( WREB1706!ItemId , LinkedNDC11Set!originalProdId )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountWREB1706!externalLineLinkId ), ISBLANK(
      WREB1706!externalLineLinkId ) ), ( UnqCountWREB1706!externalLineLinkId =
      WREB1706!externalLineLinkId ) )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountWREB1706!OrigRefNum ), ISBLANK( WREB1706!OrigRefNum ) ),
      ( UnqCountWREB1706!OrigRefNum = WREB1706!OrigRefNum ) )</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Sum of Uniqued 12 Month Wholesaler Rebates" drivingWorksheet="UnqWREB1706"
    name="UnqWREB1706Sum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqWREB1706!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqWREB1706!qty)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Uniqued 12 Month Wholesaler Rebates Aggregate Data" drivingWorksheet="UnqWREB1706"
    name="UnqWREB1706Link" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqWREB1706!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqWREB1706!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>UnqWREB1706!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>UnqWREB1706!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>UnqWREB1706!contractId</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>UnqWREB1706!externalLineLinkId</GroupingExpression>
    <GroupingExpression>UnqWREB1706!custId</GroupingExpression>
    <GroupingExpression>UnqWREB1706!contractId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    drivingWorksheet="REB1707" name="REB1707Sum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by product"
      displayName="Amount" name="amt" type="decimal">
      <Expr>SUM ( REB1707!RebatePaymentAmt )</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="12 Month Direct Rebates Aggregate Data" drivingWorksheet="REB1707"
    name="REB1707Link" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Period"
      displayName="Period" name="period" type="string">
      <Dimension name="period" />
      <Expr>tostring( REB1707!selDate, "YYYY" ) || "Q" || tostring( REB1707!selDate, "Q" )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="amount formula for aggregating sales in this data source by net price grouping rules"
      displayName="Amount" name="amt" type="decimal">
      <Expr>SUM ( REB1707!RebatePaymentAmt )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="quantity formula for aggregating sales in this data source by net price grouping rules"
      displayName="Quantity" name="qty" type="decimal">
      <Expr>NULL</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>REB1707!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Customer" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <Expr>REB1707!custId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false"
      description="Used By Net Price Grouping Rules" displayName="Contract" name="contractId"
      type="extcontractid">
      <Dimension name="contractId" />
      <Expr>REB1707!contractId</Expr>
      <CoalesceValue>-1</CoalesceValue>
    </Column>
    <GroupingExpression>tostring( REB1707!selDate, "YYYY" ) || "Q" || tostring( REB1707!selDate, "Q"
      )</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>REB1707!externalLineLinkId</GroupingExpression>
    <GroupingExpression>REB1707!custId</GroupingExpression>
    <GroupingExpression>REB1707!contractId</GroupingExpression>
    <CalcFilter>NOT(ISBLANK(LinkedNDC11Set!originalProdId))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="REB1707"
    name="UnqCountREB1707" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Orig Ref Num"
      name="OrigRefNum" type="integer">
      <Expr>REB1707!OrigRefNum</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>REB1707!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="lineCount" type="integer">
      <Expr>count(1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>REB1707!externalLineLinkId</Expr>
    </Column>
    <GroupingExpression>REB1707!externalLineLinkId</GroupingExpression>
    <GroupingExpression>REB1707!OrigRefNum</GroupingExpression>
    <GroupingExpression>REB1707!itemId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE" drivingWorksheet="REB1707"
    name="UnqREB1707" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="linkedItemId" />
      <Expr>REB1707!ItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(REB1707!InvoiceQuantity/UnqCountREB1707!lineCount)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>SUM ( REB1707!RebatePaymentAmt )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>REB1707!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>REB1707!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>REB1707!contractId</Expr>
    </Column>
    <GroupingExpression>REB1707!itemId</GroupingExpression>
    <GroupingExpression>REB1707!externalLineLinkId</GroupingExpression>
    <GroupingExpression>REB1707!custId</GroupingExpression>
    <GroupingExpression>REB1707!contractId</GroupingExpression>
    <GroupingExpression>REB1707!origRefNum</GroupingExpression>
    <CalcFilter>in( REB1707!ItemId , LinkedNDC11Set!originalProdId )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountREB1707!externalLineLinkId ), ISBLANK(
      REB1707!externalLineLinkId ) ), ( UnqCountREB1707!externalLineLinkId =
      REB1707!externalLineLinkId ) )</CalcFilter>
    <CalcFilter>OR ( AND( ISBLANK( UnqCountREB1707!OrigRefNum ), ISBLANK( REB1707!OrigRefNum ) ), (
      UnqCountREB1707!OrigRefNum = REB1707!OrigRefNum ) )</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    displayName="Sum of Uniqued 12 Month Direct Rebates" drivingWorksheet="UnqREB1707"
    name="UnqREB1707Sum" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="itemId" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqREB1707!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqREB1707!qty)</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NET_PRICE"
    displayName="Uniqued 12 Month Direct Rebates Aggregate Data" drivingWorksheet="UnqREB1707"
    name="UnqREB1707Link" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Item ID"
      displayName="Item ID" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>LinkedNDC11Set!originalProdId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" description="Linked Item ID"
      displayName="Linked Item ID" name="linkedItemID" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>LinkedNDC11Set!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Amount" name="amt"
      type="decimal">
      <Expr>sum(UnqREB1707!amt)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Quantity" name="qty"
      type="decimal">
      <Expr>sum(UnqREB1707!qty * LinkedNDC11Set!unitsConversion)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>UnqREB1707!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="custId" type="customerid">
      <Dimension name="custId" />
      <Expr>UnqREB1707!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>UnqREB1707!contractId</Expr>
    </Column>
    <GroupingExpression>LinkedNDC11Set!originalProdId</GroupingExpression>
    <GroupingExpression>LinkedNDC11Set!linkedItemId</GroupingExpression>
    <GroupingExpression>UnqREB1707!externalLineLinkId</GroupingExpression>
    <GroupingExpression>UnqREB1707!custId</GroupingExpression>
    <GroupingExpression>UnqREB1707!contractId</GroupingExpression>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="ResultWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    description="NDC11 Workbook Result Components" drivingWorksheet="NDC11Set" name="NDC11"
    persisted="false">
    <Column DisplayStyle="NONE" DynamicEntryType="ResultColumn" IsInternal="false"
      displayName="Item" name="itemID" type="itemid">
      <Dimension name="itemId" />
      <Expr>NDC11Set!originalProdId</Expr>
    </Column>
    <Column DisplayStyle="NONE" DynamicEntryType="ResultColumn" IsInternal="false" displayName="NDC"
      name="ndc" type="ndc">
      <Expr>NDC11Set!ndc</Expr>
    </Column>
    <Column DisplayStyle="NONE" DynamicEntryType="ResultColumn" IsInternal="false"
      displayName="NFAMP $/Pkg" name="calcprice" type="calcprice">
      <Expr>round(NDC11!amt6 / NDC11!qty6,2)</Expr>
    </Column>
    <Column DisplayStyle="NONE" DynamicEntryType="ResultColumn" IsInternal="false"
      description="Product algorithm: NFAMPQTR.FQD (First Quarter Direct Method), NFAMPQTR.FQW (First Quarter Wholesaler Method), NFAMPQTR.D (Direct Method), NFAMPQTR.W (Wholesaler Method)"
      displayName="Algorithm" name="algorithm" type="algorithm">
      <Expr>IF( (W_DIRSum!inv_qty / DIRSum!inv_qty) &lt; [$DirectMethodThreshold],
        IF( NDC11Set!isFQFlg = 1, "NFAMPQTR.FQD", "NFAMPQTR.D" ) ,
        IF( NDC11Set!isFQFlg = 1, "NFAMPQTR.FQW", "NFAMPQTR.W" ) )</Expr>
    </Column>
    <Column DisplayOrderNum="260" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" displayName="Last Filed NFAMP" name="amt7" type="amount">
      <Expr>pq1NFAMP!amt</Expr>
    </Column>
    <Column DisplayOrderNum="250" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" displayName="Net $" name="amt6" type="amount">
      <Expr>if ( OR ( NDC11!algorithm = "NFAMPQTR.W" , NDC11!algorithm = "NFAMPQTR.FQW" ) ,
        NDC11!amt9 - NDC11!amt20 - NDC11!amt19 - NDC11!amt10 - NDC11!amt11 - NDC11!amt12 ,
        NDC11!amt1 - NDC11!amt4 - NDC11!amt8 - NDC11!amt5 )</Expr>
    </Column>
    <Column DisplayOrderNum="350" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" displayName="Net Units" name="qty6" type="quantity">
      <Expr>if ( OR ( NDC11!algorithm = "NFAMPQTR.W" , NDC11!algorithm = "NFAMPQTR.FQW" ) ,
        NDC11!qty3 - NDC11!qty5 - NDC11!qty4 , NDC11!qty1 - NDC11!qty8 )</Expr>
    </Column>
    <Column DisplayOrderNum="200" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="NF_DIR" displayName="Non Federal Direct Sales $" name="amt1"
      type="amount">
      <Expr>NF_DIRSum!amt - NomExcValues!DIR_12MAmt</Expr>
    </Column>
    <Column DisplayOrderNum="201" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="W_DIR" displayName="Wholesaler Direct Sales $" name="amt9"
      type="amount">
      <Expr>W_DIRSum!amt - NomExcValues!DIR_12MAmt</Expr>
    </Column>
    <Column DisplayOrderNum="210" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="IND" displayName="Indirect Sales $" name="amt2"
      type="amount">
      <Expr>INDSum!amt - NomExcValues!IND_12MAmt</Expr>
    </Column>
    <Column DisplayOrderNum="220" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="CHB" displayName="Chargebacks $" name="amt3" type="amount">
      <Expr>CHBSum!amt - NomExcValues!CHB_12MAmt</Expr>
    </Column>
    <Column DisplayOrderNum="230" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="D_REB" displayName="Direct Rebates $" name="amt4"
      type="amount">
      <Expr>D_REBSum!amt</Expr>
    </Column>
    <Column DisplayOrderNum="231" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="W_REB" displayName="Wholesaler Rebates $" name="amt10"
      type="amount">
      <Expr>W_REBSum!amt</Expr>
    </Column>
    <Column DisplayOrderNum="215" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="XD_REB" displayName="Direct Excludable Rebates $"
      name="amt8" type="amount">
      <Expr>XD_REBSum!amt</Expr>
    </Column>
    <Column DisplayOrderNum="216" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="XW_REB" displayName="Wholesaler Excludable Rebates $"
      name="amt11" type="amount">
      <Expr>XW_REBSum!amt</Expr>
    </Column>
    <Column DisplayOrderNum="240" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="D_CUS" displayName="Direct Financial Adjustment $"
      name="amt5" type="amount">
      <Expr>D_CUSSum!amt</Expr>
    </Column>
    <Column DisplayOrderNum="241" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="W_CUS" displayName="Wholesaler Financial Adjustment $"
      name="amt12" type="amount">
      <Expr>W_CUSSum!amt</Expr>
    </Column>
    <Column DisplayOrderNum="300" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="NF_DIR" displayName="Non Federal Direct Sales Units"
      name="qty1" type="quantity">
      <Expr>NF_DIRSum!inv_qty - NomExcValues!DIR_12MQty</Expr>
    </Column>
    <Column DisplayOrderNum="301" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="W_DIR" displayName="Wholesaler Direct Sales Units"
      name="qty3" type="quantity">
      <Expr>W_DIRSum!inv_qty - NomExcValues!DIR_12MQty</Expr>
    </Column>
    <Column DisplayOrderNum="310" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="IND" displayName="Indirect Sales Units" name="qty2"
      type="quantity">
      <Expr>INDSum!inv_qty - NomExcValues!IND_12MQty</Expr>
    </Column>
    <Column DisplayOrderNum="315" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="XD_REB" displayName="Direct Excludable Rebates Units"
      name="qty8" type="quantity">
      <Expr>XD_REBSum!inv_qty</Expr>
    </Column>
    <Column DisplayOrderNum="316" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="XW_REB" displayName="Wholesaler Excludable Rebates Units"
      name="qty4" type="quantity">
      <Expr>XW_REBSum!inv_qty</Expr>
    </Column>
    <Column DisplayOrderNum="320" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="W_DIR_12M" displayName="12 Month Wholesaler Direct Sales $"
      name="amt13" type="amount">
      <Expr>W_DIR_12MSum!amt - NomExcValues_12M!DIR_12MAmt</Expr>
    </Column>
    <Column DisplayOrderNum="321" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="W_DIR_12M"
      displayName="12 Month Wholesaler Direct Sales Units" name="qty9" type="quantity">
      <Expr>W_DIR_12MSum!inv_qty - NomExcValues_12M!DIR_12MQty</Expr>
    </Column>
    <Column DisplayOrderNum="210" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="IND_12M" displayName="12 Month Indirect Sales $"
      name="amt14" type="amount">
      <Expr>IND_12MSum!amt - NomExcValues_12M!IND_12MAmt</Expr>
    </Column>
    <Column DisplayOrderNum="310" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="IND_12M" displayName="12 Month Indirect Sales Units"
      name="qty10" type="quantity">
      <Expr>IND_12MSum!inv_qty - NomExcValues_12M!IND_12MQty</Expr>
    </Column>
    <Column DisplayOrderNum="220" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="CHB_12M" displayName="12 Month Chargebacks $" name="amt15"
      type="amount">
      <Expr>CHB_12MSum!amt - NomExcValues_12M!CHB_12MAmt</Expr>
    </Column>
    <Column DisplayOrderNum="315" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="XD_REB_12M"
      displayName="12 Month Direct Excludable Rebates Units" name="qty11" type="quantity">
      <Expr>XD_REB_12MSum!inv_qty</Expr>
    </Column>
    <Column DisplayOrderNum="316" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="XW_REB_12M"
      displayName="12 Month Wholesaler Excludable Rebates Units" name="qty12" type="quantity">
      <Expr>XW_REB_12MSum!inv_qty</Expr>
    </Column>
    <Column DisplayOrderNum="330" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" displayName="Dollar Smoothing Ratio" name="dec1" type="decimal">
      <Expr>NDC11!amt9 / NDC11!amt13</Expr>
    </Column>
    <Column DisplayOrderNum="331" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" displayName="Package Smoothing Ratio" name="dec2" type="decimal">
      <Expr>NDC11!qty3 / NDC11!qty9</Expr>
    </Column>
    <Column DisplayOrderNum="332" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" displayName="Excludable Rebates Smoothing Ratio" name="dec3" type="decimal">
      <Expr>NDC11!amt9 / NDC11!amt13</Expr>
    </Column>
    <Column DisplayOrderNum="360" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" description="Quarterly Weighted WAC" displayName="Weighted Average WAC"
      name="amt18" type="amount">
      <Expr>DollarWWAC!amt</Expr>
    </Column>
    <Column DisplayOrderNum="370" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" description="Smoothed Chargebacks" displayName="Smoothed Chargebacks $"
      name="amt19" type="amount">
      <Expr>NDC11!dec1 * NDC11!amt15</Expr>
    </Column>
    <Column DisplayOrderNum="380" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" description="Smoothed Indirect Sales Units"
      displayName="Smoothed Indirect Sales Units" name="qty5" type="quantity">
      <Expr>NDC11!dec2 * NDC11!qty10</Expr>
    </Column>
    <Column DisplayOrderNum="390" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" description="Smoothed Indirect Sales"
      displayName="Smoothed Indirect Sales $" name="amt20" type="amount">
      <Expr>( NDC11!amt18 * NDC11!qty2 * ( 1 - [$AssumedPromptPayDiscount] ) ) * ( NDC11!dec1 )</Expr>
    </Column>
    <Column DisplayOrderNum="400" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" description="Wholesaler IS Ratio" displayName="Wholesaler Ratio"
      name="amt21" type="amount">
      <Expr>( NDC11!amt9 - NDC11!amt20 - NDC11!amt11 ) / ( NDC11!amt9 )</Expr>
    </Column>
    <Column DisplayOrderNum="410" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" description="Wholesaler Adjusted Rebates"
      displayName="Wholesaler Adjusted Rebates $" name="amt22" type="amount">
      <Expr>( NDC11!amt23 * NDC11!amt21 )</Expr>
    </Column>
    <Column DisplayOrderNum="420" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="WREB1706" description="12 Month Wholesaler Rebates $"
      displayName="12 Month Wholesaler Rebates $" name="amt23" type="amount">
      <Expr>WREB1706Sum!amt</Expr>
    </Column>
    <Column DisplayOrderNum="430" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" WorksheetName="REB1707" description="12 Month Direct Rebates $"
      displayName="12 Month Direct Rebates $" name="amt24" type="amount">
      <Expr>REB1707Sum!amt</Expr>
    </Column>
    <Column DisplayOrderNum="440" DisplayStyle="DETAIL" DynamicEntryType="ResultColumn"
      IsInternal="false" description="Smoothed Excludable Rebates"
      displayName="Smoothed Excludable Rebates Units" name="amt16" type="amount">
      <Expr />
    </Column>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="W_DIR"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.W_DIR}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="total_inv_amt"
      description="Total Invoice Amount" name="TotalInvoiceAmount" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      description="Invoice Quantity" name="InvoiceQuantity" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="coalesce(ppd,0)"
      description="PPD in a direct sale" name="PromptPayDiscount" type="none" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="DIR"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.DIR}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="total_inv_amt"
      description="Total Invoice Amount" name="TotalInvoiceAmount" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      description="Invoice Quantity" name="InvoiceQuantity" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="coalesce(ppd,0)"
      description="PPD in a direct sale" name="PromptPayDiscount" type="none" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="NF_DIR"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.NF_DIR}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="total_inv_amt"
      description="Total Invoice Amount" name="TotalInvoiceAmount" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      description="Invoice Quantity" name="InvoiceQuantity" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="coalesce(ppd,0)"
      description="PPD in a direct sale" name="PromptPayDiscount" type="none" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="IND"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.IND}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      description="Invoice Quantity" name="InvoiceQuantity" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="distr_cost_amt"
      description="Transactional WAC" name="DistributorCostAmt" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="CHB"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.CHB}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="paid_chgbk_amt"
      description="Paid Chargeback Amount" name="PaidChgbkAmt" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="W_REB"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="orig_ref_num" name="OrigRefNum"
      type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.W_REB}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="rebate_payment_amt"
      description="Rebate Payment Amount" name="RebatePaymentAmt" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      name="InvoiceQuantity" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="D_REB"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="orig_ref_num" name="OrigRefNum"
      type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.D_REB}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="rebate_payment_amt"
      description="Rebate Payment Amount" name="RebatePaymentAmt" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      name="InvoiceQuantity" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="XW_REB"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="orig_ref_num" name="OrigRefNum"
      type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.XW_REB}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="rebate_payment_amt"
      description="Rebate Payment Amount" name="RebatePaymentAmt" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="BASE_PRICE"
      description="Invoice Date WAC" name="InvDateWACPrice" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      name="InvoiceQuantity" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="XD_REB"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="orig_ref_num" name="OrigRefNum"
      type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.XD_REB}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="rebate_payment_amt"
      description="Rebate Payment Amount" name="RebatePaymentAmt" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="BASE_PRICE"
      description="Invoice Date WAC" name="InvDateWACPrice" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      name="InvoiceQuantity" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="W_CUS"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.W_CUS}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="financial_adjustment_amt"
      description="Financial Adjustment Amount" name="FinancialAdjustmentAmount" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="D_CUS"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.D_CUS}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="financial_adjustment_amt"
      description="Financial Adjustment Amount" name="FinancialAdjustmentAmount" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="DIR_12M"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.DIR_12M}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="total_inv_amt"
      description="Total Invoice Amount" name="TotalInvoiceAmount" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      description="Invoice Quantity" name="InvoiceQuantity" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="coalesce(ppd,0)"
      description="PPD in a direct sale" name="PromptPayDiscount" type="none" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="W_DIR_12M"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.W_DIR_12M}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="total_inv_amt"
      description="Total Invoice Amount" name="TotalInvoiceAmount" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      description="Invoice Quantity" name="InvoiceQuantity" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="coalesce(ppd,0)"
      description="PPD in a direct sale" name="PromptPayDiscount" type="none" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="IND_12M"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.IND_12M}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      description="Invoice Quantity" name="InvoiceQuantity" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="paid_chgbk_amt"
      description="Paid Chargeback Amount" name="PaidChgbkAmt" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="CHB_12M"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.CHB_12M}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="paid_chgbk_amt"
      description="Paid Chargeback Amount" name="PaidChgbkAmt" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="XW_REB_12M"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="orig_ref_num" name="OrigRefNum"
      type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.XW_REB_12M}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="rebate_payment_amt"
      description="Rebate Payment Amount" name="RebatePaymentAmt" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="BASE_PRICE"
      description="Invoice Date WAC" name="InvDateWACPrice" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      name="InvoiceQuantity" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="XD_REB_12M"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="orig_ref_num" name="OrigRefNum"
      type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.XD_REB_12M}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="rebate_payment_amt"
      description="Rebate Payment Amount" name="RebatePaymentAmt" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="BASE_PRICE"
      description="Invoice Date WAC" name="InvDateWACPrice" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      name="InvoiceQuantity" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="WREB1706"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="orig_ref_num" name="OrigRefNum"
      type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.WREB1706}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="rebate_payment_amt"
      description="Rebate Payment Amount" name="RebatePaymentAmt" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      name="InvoiceQuantity" type="decimal" />
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="DBWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="DATA_SOURCE" name="REB1707"
    persisted="false">
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="external_line_link_id"
      description="External Line Link ID" displayName="External Line Link ID"
      name="externalLineLinkId" type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="contracted_cust_id"
      description="Contracted Customer ID" displayName="Contracted Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="struct_doc_id"
      description="Struct Doc ID" displayName="Struct Doc ID" name="contractId" type="extcontractid">
      <Dimension name="contractId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="item_id" name="ItemId"
      type="itemid">
      <Dimension name="linkedItemId" />
    </Column>
    <Column DynamicEntryType="DBColumn" IsInternal="true" dBColName="orig_ref_num" name="OrigRefNum"
      type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="true"
      dBColName="{calculationBasis.saleDateColumnMap.REB1707}" name="selDate" type="none" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="rebate_payment_amt"
      description="Rebate Payment Amount" name="RebatePaymentAmt" type="decimal" />
    <Column DynamicEntryType="DBColumn" IsInternal="false" dBColName="inv_qty"
      name="InvoiceQuantity" type="decimal" />
  </Worksheet>
  <Worksheet CacheTableName="mn_gp_dir_datacache" CmsUnits="false" DynamicEntryType="CacheWorksheet"
    IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    drivingWorksheet="DirectSale" name="DIRmapping" persisted="false">
    <Column CacheColName="Str1" DynamicEntryType="CacheColumn" IsInternal="false" name="ProductName"
      type="string">
      <Expr>ProductName</Expr>
    </Column>
    <Column CacheColName="Str2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="TransactionTypeCode" type="string">
      <Expr>TransactionTypeCode</Expr>
    </Column>
    <Column CacheColName="Str3" DynamicEntryType="CacheColumn" IsInternal="false" name="NDCNumber"
      type="string">
      <Expr>NDCNumber</Expr>
    </Column>
    <Column CacheColName="Str4" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalLineRefId" type="string">
      <Expr>ExternalLineRefId</Expr>
    </Column>
    <Column CacheColName="Enum1" DynamicEntryType="CacheColumn" IsInternal="false" name="InvoiceUOM"
      type="enum">
      <Expr>InvoiceUOM</Expr>
    </Column>
    <Column CacheColName="ExternalLineLinkId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalLineLinkID" type="string">
      <Expr>ExternalLineLinkID</Expr>
    </Column>
    <Column CacheColName="Date1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalTransactionDate" type="date">
      <Expr>ExternalTransactionDate</Expr>
    </Column>
    <Column CacheColName="Dec1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvoiceQuantity" type="decimal">
      <Expr>InvoiceQuantity</Expr>
    </Column>
    <Column CacheColName="Money1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="TotalInvoiceAmount" type="money">
      <Expr>TotalInvoiceAmount</Expr>
    </Column>
    <Column CacheColName="Date2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvoiceDateSql" type="date">
      <Expr>InvoiceDateSql</Expr>
    </Column>
    <Column CacheColName="Money2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvoiceAmount" type="money">
      <Expr>InvoiceAmount</Expr>
    </Column>
    <Column CacheColName="Enum2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerCOT" type="enum">
      <Expr>CustomerCOT</Expr>
    </Column>
    <Column CacheColName="Str6" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerNumber" type="string">
      <Expr>CustomerNumber</Expr>
    </Column>
    <Column CacheColName="Date3" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SubmissionCloseDate" type="date">
      <Expr>SubmissionCloseDate</Expr>
    </Column>
    <Column CacheColName="Str7" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerName" type="string">
      <Expr>CustomerName</Expr>
    </Column>
    <Column CacheColName="Money3" DynamicEntryType="CacheColumn" IsInternal="false"
      name="DiscountedTotalInvoiceAmount" type="money">
      <Expr>DiscountedTotalInvoiceAmount</Expr>
    </Column>
    <Column CacheColName="Dec2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="PromptPayDiscount" type="decimal">
      <Expr>PromptPayDiscount</Expr>
    </Column>
    <Column CacheColName="Enum3" DynamicEntryType="CacheColumn" IsInternal="false" name="Accuracy"
      type="enum">
      <Expr>Accuracy</Expr>
    </Column>
    <Column CacheColName="SaleId" DynamicEntryType="CacheColumn" IsInternal="false" name="SaleId"
      type="integer">
      <Expr>SaleId</Expr>
    </Column>
    <Column CacheColName="SaleMgrId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SaleMgrId" type="integer">
      <Expr>SaleMgrId</Expr>
    </Column>
    <Column CacheColName="ItemId" DynamicEntryType="CacheColumn" IsInternal="false" name="ItemId"
      type="itemid">
      <Expr>ItemId</Expr>
    </Column>
    <Column CacheColName="StructDocId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="StructDocId" type="extcontractid">
      <Expr>StructDocId</Expr>
    </Column>
    <Column CacheColName="ContractedCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ContractedCustomerId" type="customerid">
      <Expr>ContractedCustomerId</Expr>
    </Column>
    <Column CacheColName="BillToCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="BillToCustomerId" type="integer">
      <Expr>BillToCustomerId</Expr>
    </Column>
    <Column CacheColName="SoldToCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SoldToCustomerId" type="integer">
      <Expr>SoldToCustomerId</Expr>
    </Column>
    <Column CacheColName="ProductGroupId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ProductGroupId" type="integer">
      <Expr>ProductGroupId</Expr>
    </Column>
  </Worksheet>
  <Worksheet CacheTableName="mn_gp_indir_datacache" CmsUnits="false"
    DynamicEntryType="CacheWorksheet" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
    Removable="false" UsageType="NONE" drivingWorksheet="IndirectSale" name="INDmapping"
    persisted="false">
    <Column CacheColName="Str1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="WholesalerNumber" type="string">
      <Expr>WholesalerNumber</Expr>
    </Column>
    <Column CacheColName="Str2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="TransactionTypeCode" type="string">
      <Expr>TransactionTypeCode</Expr>
    </Column>
    <Column CacheColName="Str3" DynamicEntryType="CacheColumn" IsInternal="false"
      name="WholesalerName" type="string">
      <Expr>WholesalerName</Expr>
    </Column>
    <Column CacheColName="Date1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ChargebackCloseDate" type="date">
      <Expr>ChargebackCloseDate</Expr>
    </Column>
    <Column CacheColName="Money1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="DistributorCostAmt" type="money">
      <Expr>DistributorCostAmt</Expr>
    </Column>
    <Column CacheColName="Money2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="PaidChgbkAmt" type="money">
      <Expr>PaidChgbkAmt</Expr>
    </Column>
    <Column CacheColName="Str4" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ContractNumber" type="string">
      <Expr>ContractNumber</Expr>
    </Column>
    <Column CacheColName="Enum1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerCOT" type="enum">
      <Expr>CustomerCOT</Expr>
    </Column>
    <Column CacheColName="Str5" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerNumber" type="string">
      <Expr>CustomerNumber</Expr>
    </Column>
    <Column CacheColName="Str6" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerName" type="string">
      <Expr>CustomerName</Expr>
    </Column>
    <Column CacheColName="Str7" DynamicEntryType="CacheColumn" IsInternal="false" name="ProductName"
      type="string">
      <Expr>ProductName</Expr>
    </Column>
    <Column CacheColName="Str8" DynamicEntryType="CacheColumn" IsInternal="false" name="NDCNumber"
      type="string">
      <Expr>NDCNumber</Expr>
    </Column>
    <Column CacheColName="Str9" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalLineRefId" type="string">
      <Expr>ExternalLineRefId</Expr>
    </Column>
    <Column CacheColName="Enum2" DynamicEntryType="CacheColumn" IsInternal="false" name="InvoiceUOM"
      type="enum">
      <Expr>InvoiceUOM</Expr>
    </Column>
    <Column CacheColName="ExternalLineLinkId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalLineLinkID" type="string">
      <Expr>ExternalLineLinkID</Expr>
    </Column>
    <Column CacheColName="Date2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalTransactionDate" type="date">
      <Expr>ExternalTransactionDate</Expr>
    </Column>
    <Column CacheColName="Dec1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvoiceQuantity" type="decimal">
      <Expr>InvoiceQuantity</Expr>
    </Column>
    <Column CacheColName="Money3" DynamicEntryType="CacheColumn" IsInternal="false"
      name="TotalInvoiceAmount" type="money">
      <Expr>TotalInvoiceAmount</Expr>
    </Column>
    <Column CacheColName="Enum3" DynamicEntryType="CacheColumn" IsInternal="false" name="SaleType"
      type="enum">
      <Expr>SaleType</Expr>
    </Column>
    <Column CacheColName="Date3" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvoiceDateSql" type="date">
      <Expr>InvoiceDateSql</Expr>
    </Column>
    <Column CacheColName="Money4" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvoiceAmount" type="money">
      <Expr>InvoiceAmount</Expr>
    </Column>
    <Column CacheColName="Date4" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalPaidDate" type="date">
      <Expr>ExternalPaidDate</Expr>
    </Column>
    <Column CacheColName="Date5" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SubmissionCloseDate" type="date">
      <Expr>SubmissionCloseDate</Expr>
    </Column>
    <Column CacheColName="Enum4" DynamicEntryType="CacheColumn" IsInternal="false" name="Accuracy"
      type="enum">
      <Expr>Accuracy</Expr>
    </Column>
    <Column CacheColName="SaleId" DynamicEntryType="CacheColumn" IsInternal="false" name="SaleId"
      type="integer">
      <Expr>SaleId</Expr>
    </Column>
    <Column CacheColName="SaleMgrId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SaleMgrId" type="integer">
      <Expr>SaleMgrId</Expr>
    </Column>
    <Column CacheColName="ItemId" DynamicEntryType="CacheColumn" IsInternal="false" name="ItemId"
      type="itemid">
      <Expr>ItemId</Expr>
    </Column>
    <Column CacheColName="StructDocId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="StructDocId" type="extcontractid">
      <Expr>StructDocId</Expr>
    </Column>
    <Column CacheColName="ContractedCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ContractedCustomerId" type="customerid">
      <Expr>ContractedCustomerId</Expr>
    </Column>
    <Column CacheColName="BillToCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="BillToCustomerId" type="integer">
      <Expr>BillToCustomerId</Expr>
    </Column>
    <Column CacheColName="SoldToCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SoldToCustomerId" type="integer">
      <Expr>SoldToCustomerId</Expr>
    </Column>
    <Column CacheColName="ProductGroupId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ProductGroupId" type="integer">
      <Expr>ProductGroupId</Expr>
    </Column>
    <Column CacheColName="ParentDistributorId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ParentDistributorId" type="integer">
      <Expr>ParentDistributorId</Expr>
    </Column>
  </Worksheet>
  <Worksheet CacheTableName="mn_gp_custom_datacache" CmsUnits="false"
    DynamicEntryType="CacheWorksheet" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
    Removable="false" UsageType="NONE" drivingWorksheet="CustomSale" name="ADJmapping"
    persisted="false">
    <Column CacheColName="Str1" DynamicEntryType="CacheColumn" IsInternal="false" name="ProductName"
      type="string">
      <Expr>ProductName</Expr>
    </Column>
    <Column CacheColName="Str2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="TransactionTypeCode" type="string">
      <Expr>TransactionTypeCode</Expr>
    </Column>
    <Column CacheColName="Str3" DynamicEntryType="CacheColumn" IsInternal="false" name="NDCNumber"
      type="string">
      <Expr>NDCNumber</Expr>
    </Column>
    <Column CacheColName="Enum1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomSaleType" type="enum">
      <Expr>CustomSaleType</Expr>
    </Column>
    <Column CacheColName="Str4" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalLineRefId" type="string">
      <Expr>ExternalLineRefId</Expr>
    </Column>
    <Column CacheColName="Enum2" DynamicEntryType="CacheColumn" IsInternal="false" name="InvoiceUOM"
      type="enum">
      <Expr>InvoiceUOM</Expr>
    </Column>
    <Column CacheColName="ExternalLineLinkId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalLineLinkID" type="string">
      <Expr>ExternalLineLinkID</Expr>
    </Column>
    <Column CacheColName="Date1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalTransactionDate" type="date">
      <Expr>ExternalTransactionDate</Expr>
    </Column>
    <Column CacheColName="Dec1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvoiceQuantity" type="decimal">
      <Expr>InvoiceQuantity</Expr>
    </Column>
    <Column CacheColName="Date2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvoiceDateSql" type="date">
      <Expr>InvoiceDateSql</Expr>
    </Column>
    <Column CacheColName="Enum3" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerCOT" type="enum">
      <Expr>CustomerCOT</Expr>
    </Column>
    <Column CacheColName="Date3" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalProcessDate" type="date">
      <Expr>ExternalProcessDate</Expr>
    </Column>
    <Column CacheColName="Str6" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerNumber" type="string">
      <Expr>CustomerNumber</Expr>
    </Column>
    <Column CacheColName="Date4" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SubmissionCloseDate" type="date">
      <Expr>SubmissionCloseDate</Expr>
    </Column>
    <Column CacheColName="Str7" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerName" type="string">
      <Expr>CustomerName</Expr>
    </Column>
    <Column CacheColName="Money1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="FinancialAdjustmentAmount" type="money">
      <Expr>FinancialAdjustmentAmount</Expr>
    </Column>
    <Column CacheColName="Enum4" DynamicEntryType="CacheColumn" IsInternal="false" name="Accuracy"
      type="enum">
      <Expr>Accuracy</Expr>
    </Column>
    <Column CacheColName="SaleId" DynamicEntryType="CacheColumn" IsInternal="false" name="SaleId"
      type="integer">
      <Expr>SaleId</Expr>
    </Column>
    <Column CacheColName="SaleMgrId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SaleMgrId" type="integer">
      <Expr>SaleMgrId</Expr>
    </Column>
    <Column CacheColName="ItemId" DynamicEntryType="CacheColumn" IsInternal="false" name="ItemId"
      type="itemid">
      <Expr>ItemId</Expr>
    </Column>
    <Column CacheColName="StructDocId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="StructDocId" type="extcontractid">
      <Expr>StructDocId</Expr>
    </Column>
    <Column CacheColName="ContractedCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ContractedCustomerId" type="customerid">
      <Expr>ContractedCustomerId</Expr>
    </Column>
    <Column CacheColName="BillToCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="BillToCustomerId" type="integer">
      <Expr>BillToCustomerId</Expr>
    </Column>
    <Column CacheColName="SoldToCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SoldToCustomerId" type="integer">
      <Expr>SoldToCustomerId</Expr>
    </Column>
    <Column CacheColName="ProductGroupId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ProductGroupId" type="integer">
      <Expr>ProductGroupId</Expr>
    </Column>
  </Worksheet>
  <Worksheet CacheTableName="mn_gp_rbtpmt_datacache" CmsUnits="false"
    DynamicEntryType="CacheWorksheet" IsMaster="false" Offset="0" Precision="6" ProductGroup="NONE"
    Removable="false" UsageType="NONE" drivingWorksheet="RbtPmtSale" name="REBmapping"
    persisted="false">
    <Column CacheColName="Str1" DynamicEntryType="CacheColumn" IsInternal="false" name="ProductName"
      type="string">
      <Expr>ProductName</Expr>
    </Column>
    <Column CacheColName="Str2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="TransactionTypeCode" type="string">
      <Expr>TransactionTypeCode</Expr>
    </Column>
    <Column CacheColName="Int1" DynamicEntryType="CacheColumn" IsInternal="false" name="OrigRefNum"
      type="integer">
      <Expr>OrigRefNum</Expr>
    </Column>
    <Column CacheColName="Str3" DynamicEntryType="CacheColumn" IsInternal="false" name="NDCNumber"
      type="string">
      <Expr>NDCNumber</Expr>
    </Column>
    <Column CacheColName="Str4" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalLineRefId" type="string">
      <Expr>ExternalLineRefId</Expr>
    </Column>
    <Column CacheColName="Money1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvDateWACPrice" type="money">
      <Expr>InvDateWACPrice</Expr>
    </Column>
    <Column CacheColName="Enum1" DynamicEntryType="CacheColumn" IsInternal="false" name="InvoiceUOM"
      type="enum">
      <Expr>InvoiceUOM</Expr>
    </Column>
    <Column CacheColName="ExternalLineLinkId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalLineLinkID" type="string">
      <Expr>ExternalLineLinkID</Expr>
    </Column>
    <Column CacheColName="Date1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalTransactionDate" type="date">
      <Expr>ExternalTransactionDate</Expr>
    </Column>
    <Column CacheColName="Dec1" DynamicEntryType="CacheColumn" IsInternal="false"
      name="InvoiceQuantity" type="decimal">
      <Expr>InvoiceQuantity</Expr>
    </Column>
    <Column CacheColName="Money2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="RebatePaymentAmt" type="money">
      <Expr>RebatePaymentAmt</Expr>
    </Column>
    <Column CacheColName="Str6" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ContractNumber" type="string">
      <Expr>ContractNumber</Expr>
    </Column>
    <Column CacheColName="Date2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalPaidDate" type="date">
      <Expr>ExternalPaidDate</Expr>
    </Column>
    <Column CacheColName="Enum2" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerCOT" type="enum">
      <Expr>CustomerCOT</Expr>
    </Column>
    <Column CacheColName="Date3" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ExternalProcessDate" type="date">
      <Expr>ExternalProcessDate</Expr>
    </Column>
    <Column CacheColName="Str7" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerNumber" type="string">
      <Expr>CustomerNumber</Expr>
    </Column>
    <Column CacheColName="Date4" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SubmissionCloseDate" type="date">
      <Expr>SubmissionCloseDate</Expr>
    </Column>
    <Column CacheColName="Str8" DynamicEntryType="CacheColumn" IsInternal="false"
      name="CustomerName" type="string">
      <Expr>CustomerName</Expr>
    </Column>
    <Column CacheColName="Enum3" DynamicEntryType="CacheColumn" IsInternal="false" name="Accuracy"
      type="enum">
      <Expr>Accuracy</Expr>
    </Column>
    <Column CacheColName="SaleId" DynamicEntryType="CacheColumn" IsInternal="false" name="SaleId"
      type="integer">
      <Expr>SaleId</Expr>
    </Column>
    <Column CacheColName="SaleMgrId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SaleMgrId" type="integer">
      <Expr>SaleMgrId</Expr>
    </Column>
    <Column CacheColName="ItemId" DynamicEntryType="CacheColumn" IsInternal="false" name="ItemId"
      type="itemid">
      <Expr>ItemId</Expr>
    </Column>
    <Column CacheColName="StructDocId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="StructDocId" type="extcontractid">
      <Expr>StructDocId</Expr>
    </Column>
    <Column CacheColName="ContractedCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ContractedCustomerId" type="customerid">
      <Expr>ContractedCustomerId</Expr>
    </Column>
    <Column CacheColName="BillToCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="BillToCustomerId" type="integer">
      <Expr>BillToCustomerId</Expr>
    </Column>
    <Column CacheColName="SoldToCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="SoldToCustomerId" type="integer">
      <Expr>SoldToCustomerId</Expr>
    </Column>
    <Column CacheColName="ProductGroupId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="ProductGroupId" type="integer">
      <Expr>ProductGroupId</Expr>
    </Column>
    <Column CacheColName="PricingProgramId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="PricingProgramId" type="integer">
      <Expr>PricingProgramId</Expr>
    </Column>
    <Column CacheColName="PlanCustomerId" DynamicEntryType="CacheColumn" IsInternal="false"
      name="PlanCustomerId" type="integer">
      <Expr>PlanCustomerId</Expr>
    </Column>
  </Worksheet>
  <Parameter name="WorkbookYearQuarter">
    <Value> <![CDATA[  concat(concat(to_char(to_date( '{workbook.periodYearStartDate, time, yyyy-MM-dd}', 'YYYY-MM-DD'), 'YYYY') , 'Q' ), to_char(to_date( '{workbook.periodYearStartDate, time, yyyy-MM-dd}', 'YYYY-MM-DD'), 'Q'))  ]]></Value>
  </Parameter>
  <Parameter name="WbYear">
    <Value><![CDATA[{workbook.year,NUMBER,#}]]></Value>
  </Parameter>
  <Parameter name="LineStartDim">
    <Value>( to_char( to_date(
      mn_global_pkg.format_timestamp_withtz(mn_struct_line_item_ver.start_date,[$WorkbookTimezone],'yyyy-MM-dd'),
      'YYYY-MM-DD') ,'yyyyMMdd') )</Value>
  </Parameter>
  <Parameter name="LineEndDim">
    <Value>( to_char( to_date(
      mn_global_pkg.format_timestamp_withtz(mn_struct_line_item_ver.end_date,[$WorkbookTimezone],'yyyy-MM-dd'),
      'YYYY-MM-DD') ,'yyyyMMdd') )</Value>
  </Parameter>
  <Parameter name="MarketEntryDate">
    <Value>( to_date(
      mn_global_pkg.format_timestamp_withtz(mn_item_ver.market_entry_date,'{workbook.effectiveTimezoneID}','yyyy-MM-dd'),
      'YYYY-MM-DD') )</Value>
  </Parameter>
  <Parameter name="NDC11SetSelect">
    <Value>SELECT base.ndc AS ndc,
      mn_item_ver.item_id AS cat_obj_id,
      [$ItemFirstSalesDate] AS start_date,
      TRUNC(CAST(mn_item_ver.shelf_life_exp_date AS DATE)) AS end_date,
      case
      when
      [$ItemFirstSalesDate] &lt;= add_months([$PeriodEnd], -12)
      + NUMTODSINTERVAL(1,'DAY') AND
      coalesce(TRUNC(CAST(mn_item_ver.shelf_life_exp_date AS DATE)), [$PeriodStart])
      &gt;= [$PeriodStart]
      then
      1
      else
      0
      end as olderThanYearFlag, 1 as units_conversion, mn_item_ver.medicaid_units_per_pack as
      medicaid_units_per_pack,
      ([$PeriodEndDateTz]- [$MarketEntryDate] + 1) as days_active</Value>
  </Parameter>
  <Parameter name="NDC11SetFrom">
    <Value>FROM
      mn_item_ver ,
      mn_cat_map_ver base</Value>
  </Parameter>
  <Parameter name="NDC11SetWhere">
    <Value>WHERE
      ( mn_item_ver.shelf_life_exp_date IS NULL
      OR TRUNC(CAST(mn_item_ver.shelf_life_exp_date AS DATE)) &gt;= [$PeriodStart] )
      AND ( mn_item_ver.divestiture_date IS NULL
      OR TRUNC(CAST(mn_item_ver.divestiture_date AS DATE)) &gt;= [$PeriodStart] )
      AND mn_item_ver.ver_start_date &lt; [$DataCutoff]
      AND mn_item_ver.ver_end_date &gt;= [$DataCutoff]
      AND base.cat_map_id = mn_item_ver.item_id
      AND base.ndc IS NOT NULL
      AND base.ver_start_date &lt; [$DataCutoff]
      AND base.ver_end_date &gt;= [$DataCutoff]
      AND [$ProductLife] &gt; 0</Value>
  </Parameter>
  <Parameter name="W_DIR.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.W_DIR.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="DIR.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.DIR.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="NF_DIR.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.NF_DIR.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="IND.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.IND.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="CHB.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.CHB.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="D_REB.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.D_REB.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="W_REB.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.W_REB.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="XD_REB.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.XD_REB.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="XW_REB.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.XW_REB.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="D_CUS.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.D_CUS.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="W_CUS.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.W_CUS.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="DIR_12M.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.DIR_12M.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="W_DIR_12M.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.W_DIR_12M.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="IND_12M.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.IND_12M.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="CHB_12M.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.CHB_12M.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="REB_12M.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.REB_12M.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="XD_REB_12M.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.XD_REB_12M.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="XW_REB_12M.StartDate">
    <Value>{calculationBasis.dataSourceFilterMap.XW_REB_12M.startDate, time, yyyy-MM-dd HH:mm:ss}</Value>
  </Parameter>
  <Parameter name="DisplayableWorkbookQuarterPeriodOffsetsZERO">
    <Value>{workbookUtil.displayableWorkbookQuarterPeriodOffsets.0}</Value>
  </Parameter>
  <Parameter name="NOM">
    <Value>'NOMINAL'</Value>
  </Parameter>
  <Parameter name="NOTNOM">
    <Value>'NOTNOM'</Value>
  </Parameter>
  <Parameter name="EXCLUDE">
    <Value>'EXCLUDE'</Value>
  </Parameter>
  <Parameter name="ItemFirstSalesDate">
    <Value>TRUNC(CAST(mn_item_ver.first_sales_date AS DATE))</Value>
  </Parameter>
  <Parameter name="NDC11FirstSalesDateNumTemplate1">
    <Value>Select CASE
      WHEN [$FQ_Criteria] AND ([$QuarterNum]) != 2
      THEN mn_item_ver.FIRST_SALES_DATE
      ELSE to_timestamp('</Value>
  </Parameter>
  <Parameter name="NDC11FirstSalesDateNumTemplate2">
    <Value>', 'YYYY-MM-DD HH24:MI:SS')
      END
      from mn_item_ver
      where
      mn_item_ver.VER_START_DATE &lt; [$DataCutoff] AND
      mn_item_ver.VER_END_DATE &gt;= [$DataCutoff] AND
      mn_item_ver.item_id =</Value>
  </Parameter>
  <Parameter name="NDC11FirstSalesDateNumTemplateYearly1">
    <Value>Select CASE
      WHEN
      mn_item_ver.FIRST_SALES_DATE &gt;
      add_months(to_date( '{workbook.periodYearEndDate, time, yyyy-MM-dd}', 'YYYY-MM-DD'), -12) +
      NUMTODSINTERVAL(1,'DAY')
      THEN mn_item_ver.FIRST_SALES_DATE
      ELSE to_timestamp('</Value>
  </Parameter>
  <Parameter name="ProductLife">
    <Value>( [$PeriodEnd] - [$ItemFirstSalesDate] ) + 1</Value>
  </Parameter>
  <Parameter name="QuarterNum">
    <Value>select quarter from mn_date_dim where date_num = to_char(mn_item_ver.first_sales_date,
      'yyyymmdd')</Value>
  </Parameter>
  <Parameter name="2QtrsInDays">
    <Value>( [$PeriodEnd] - add_months([$PeriodEnd], -6) ) </Value>
  </Parameter>
  <Parameter name="1QtrsInDays">
    <Value>( [$PeriodEnd] - add_months([$PeriodEnd], -3) ) </Value>
  </Parameter>
  <Parameter name="0QtrsInDays">
    <Value>( [$PeriodEnd] - add_months([$PeriodEnd], -0) ) </Value>
  </Parameter>
  <Parameter name="FQ_Criteria">
    <Value>( [$ProductLife] &gt;= [$1QtrsInDays] AND [$ProductLife] &lt; [$2QtrsInDays] )</Value>
  </Parameter>
  <Parameter name="Estab_Criteria">
    <Value>( [$ProductLife] &gt;= [$2QtrsInDays] )</Value>
  </Parameter>
  <DataSourcesFilter DataSourceType="REBATES" DataSources="WREB1706" ImportAction="addModify">
    <Filter Anded="false" Description="12 Month Wholesaler Rebates" Enabled="true"
      Handle="12 Month Wholesaler Rebates-373" ImportAction="addModify" Inclusionary="true"
      Name="12 Month Wholesaler Rebates">
      <DimExp3><![CDATA[<logicalOp name="and">
<logicalOp name="and">
<comparisonOp name="lt">
<attribute direction="left" name="TX!InvoiceQuantity.Quantity"/>
<embedded direction="right">
<constant sourceType="double">1000.0</constant>
</embedded>
<property name="valueType">
<value sourceType="Class">java.lang.Double</value>
</property>
</comparisonOp>
<property name="description">
<value sourceType="String">12 Month Wholesaler Rebates</value>
</property>
<property name="exclude">
<value sourceType="boolean">false</value>
</property>
</logicalOp>
</logicalOp>
]]></DimExp3>
    </Filter>
  </DataSourcesFilter>
  <DataSourcesFilter DataSourceType="DIRECT_SALES" DataSources="W_DIR" ImportAction="addModify">
    <Filter Anded="false" Description="12 Month Direct Rebates" Enabled="true"
      Handle="Wholesaler Direct Sales-374" ImportAction="addModify" Inclusionary="true"
      Name="Wholesaler Direct Sales">
      <DimExp3><![CDATA[<logicalOp name="and">
<logicalOp name="and">
<comparisonOp name="ge">
<attribute direction="left" name="TX!InvoiceQuantity.Quantity"/>
<embedded direction="right">
<constant sourceType="double">1000.0</constant>
</embedded>
<property name="valueType">
<value sourceType="Class">java.lang.Double</value>
</property>
</comparisonOp>
<property name="description">
<value sourceType="String">Wholesaler Direct Sales</value>
</property>
<property name="exclude">
<value sourceType="boolean">false</value>
</property>
</logicalOp>
</logicalOp>
]]></DimExp3>
    </Filter>
  </DataSourcesFilter>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    drivingWorksheet="TransactionSet" name="NetPriceCalc" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="itemid">
      <Dimension name="itemId" />
      <Expr>TransactionSet!itemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Linked Item ID"
      name="linkedItemId" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>TransactionSet!linkedItemID</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Contract ID"
      name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <CoalesceValue>-1</CoalesceValue>
      <Expr>TransactionSet!contractId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <CoalesceValue>-1</CoalesceValue>
      <Expr>TransactionSet!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Period" name="period"
      type="string">
      <Dimension name="period" />
      <Expr>TransactionSet!period</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>TransactionSet!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="netPrice" type="netprice">
      <Dimension name="netPrice" />
      <Expr> IF( NOT(ISBLANK(DIR_12MLink!amt)) , NetPriceCalc!netprice_dir , IF( AND(
        NOT(ISBLANK(IND_12MLink!amt)) , ISBLANK(DIR_12MLink!amt) ) , NetPriceCalc!netprice_ind ) ) </Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="method" type="resultkind">
      <Expr> IF( NOT(ISBLANK(DIR_12MLink!amt)) , "Direct" , IF( AND( NOT(ISBLANK(IND_12MLink!amt)) ,
        ISBLANK(DIR_12MLink!amt) ) , "Indirect" ) ) </Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="netprice_dir" type="decimal">
      <Expr>if( DIR_12MLink!qty &lt;= 0,
        null,
        DIR_12MLink!amt / ( DIR_12MLink!qty )
        )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="netprice_ind" type="decimal">
      <Expr>if( IND_12MLink!qty &lt;= 0,
        null,
        IND_12MLink!amt / ( IND_12MLink!qty )
        )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="DIR_12MQty" type="decimal">
      <Expr>DIR_12MLink!qty</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="DIR_12MAmt" type="decimal">
      <Expr>DIR_12MLink!amt</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="IND_12MQty" type="decimal">
      <Expr>IND_12MLink!qty</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="IND_12MAmt" type="decimal">
      <Expr>IND_12MLink!amt</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="CHB_12MAmt" type="decimal">
      <Expr>CHB_12MLink!cbAmt</Expr>
    </Column>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    drivingWorksheet="NetPriceCalc" name="NetPriceWithLinkedProds" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="itemid">
      <Dimension name="itemId" />
      <Expr>NetPriceCalc!itemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Linked Item ID"
      name="linkedItemId" type="integer">
      <Dimension name="linkedItemId" />
      <Expr>NetPriceCalc!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="netPrice" type="netprice">
      <Dimension name="netPrice" />
      <Expr>NetPriceCalc!netPrice</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="method" type="string">
      <Expr>NetPriceCalc!method</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Contract ID"
      name="contractId" type="extcontractid">
      <Dimension name="contractId" />
      <Expr>NetPriceCalc!contractId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Customer ID" name="custId"
      type="customerid">
      <Dimension name="custId" />
      <Expr>NetPriceCalc!custId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Period" name="period"
      type="string">
      <Dimension name="period" />
      <Expr>NetPriceCalc!period</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="externalLineLinkId"
      type="externallinelinkid">
      <Dimension name="externalLineLinkId" />
      <Expr>NetPriceCalc!externalLineLinkId</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="action" type="resultkind">
      <Expr>NetPriceOverride!action</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="isFilterable" type="integer">
      <Expr>if( ISBLANK ( NominalCustomers!custId ) , 1 , 0 )</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="DIR_12MQty" type="decimal">
      <Expr>NetPriceCalc!DIR_12MQty</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="IND_12MQty" type="decimal">
      <Expr>NetPriceCalc!IND_12MQty</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="DIR_12MAmt" type="decimal">
      <Expr>NetPriceCalc!DIR_12MAmt</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="IND_12MAmt" type="decimal">
      <Expr>NetPriceCalc!IND_12MAmt</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" name="CHB_12MAmt" type="decimal">
      <Expr>NetPriceCalc!CHB_12MAmt</Expr>
    </Column>
    <CalcFilter>NOT(ISBLANK(NetPriceCalc!netPrice))</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CustomWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="NONE"
    WorksheetNames="W_DIR,DIR,NF_DIR,IND,CHB,CHB_12M,DIR_12M,IND_12M" cached="true"
    clientPrefix="Mn" displayName="Net Price Points" drivingWorksheet="NetPriceWithLinkedProds"
    modelName="NetPricePointLine" name="NETPP" packageName="com.modeln.bp.gp.wb.worksheet.netpp"
    persisted="false" tableName="mn_gp_netpp">
    <Column DynamicEntryType="CustomColumn" IsInternal="false" name="cat_obj_id" type="integer">
      <Dimension name="itemId" />
      <Expr>NetPriceWithLinkedProds!itemId</Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Linked Item ID"
      name="qty6" type="decimal">
      <Dimension name="linkedItemId" />
      <Expr>NetPriceWithLinkedProds!linkedItemId</Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Period" name="period"
      type="string">
      <Dimension name="period" />
      <Expr>NetPriceWithLinkedProds!period</Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" name="contracted_cust_id"
      type="integer">
      <Dimension name="custId" />
      <Expr>IF(NetPriceWithLinkedProds!custId = -1, NULL, NetPriceWithLinkedProds!custId)</Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" name="struct_doc_id" type="string">
      <Dimension name="contractId" />
      <Expr>IF(NetPriceWithLinkedProds!contractId = -1, NULL, NetPriceWithLinkedProds!contractId)</Expr>
    </Column>
    <Column DisplayOrderNum="5" DynamicEntryType="CustomColumn" IsInternal="false"
      displayName="Net Price" name="calc_price_amt" type="decimal">
      <Dimension name="netPrice" />
      <Expr>NetPriceWithLinkedProds!netPrice</Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Algorithm"
      name="algorithm" type="string">
      <Expr>"SIMPLE.A"</Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Current Override"
      name="str1" type="string">
      <Expr>IF( NetPriceWithLinkedProds!action = [$EXCLUDE], "Exclude Line",
        IF( NetPriceWithLinkedProds!action = [$NOTNOM], "Mark As Non-Nominal",
        IF( NetPriceWithLinkedProds!action = [$NOM], "Mark As Nominal" , "Revert" ) ) )</Expr>
    </Column>
    <Column DisplayOrderNum="10" DynamicEntryType="CustomColumn" IsInternal="false"
      displayName="Line Link ID" name="str2" type="string">
      <Dimension name="externalLineLinkId" />
      <Expr>NetPriceWithLinkedProds!externalLineLinkId</Expr>
    </Column>
    <Column DisplayOrderNum="90" DynamicEntryType="CustomColumn" IsInternal="false"
      displayName="Type" name="str3" type="string">
      <Expr>NetPriceWithLinkedProds!method</Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Result Status"
      name="str4" type="string">
      <Expr>IF( NetPriceWithLinkedProds!action = [$EXCLUDE] ,
        "EXCLUDED" ,
        IF( OR( NetPriceWithLinkedProds!action = [$NOTNOM] ,
        AND( ISBLANK( NetPriceWithLinkedProds!action ) ,
        OR(
        OR( AND(NetPriceWithLinkedProds!isFilterable = 1, OR(NominalCustomersList!custIdCount
        &lt;&gt; 0, NominalCotList!cotCount &lt;&gt; 0)) ,
        OR( [$NominalFiltering] &lt;&gt; "1" ,
        OR( NetPriceWithLinkedProds!netPrice &gt;= PriorQ3NFAMPUnion!amt * [$NominalPriceFactor],
        NetPriceWithLinkedProds!period &lt;&gt; [$WorkbookYearQuarter]
        )
        )
        ),
        AND( AND(NetPriceWithLinkedProds!isFilterable = 1, NominalCustomersList!custIdCount = 0,
        NominalCotList!cotCount = 0) ,
        OR( [$NominalFiltering] &lt;&gt; "1" ,
        OR( NetPriceWithLinkedProds!netPrice &gt;= PriorQ3NFAMPUnion!amt * [$NominalPriceFactor],
        NetPriceWithLinkedProds!period &lt;&gt; [$WorkbookYearQuarter]
        )
        )
        ),
        AND( NetPriceWithLinkedProds!isFilterable = -1 ,
        OR( [$NominalFiltering] &lt;&gt; "1" ,
        OR( NetPriceWithLinkedProds!netPrice &gt;= PriorQ3NFAMPUnion!amt * [$NominalPriceFactor],
        NetPriceWithLinkedProds!period &lt;&gt; [$WorkbookYearQuarter]
        )
        )
        )
        )
        )
        ) ,
        "NOT NOMINAL" ,
        "NOMINAL"
        )
        )
      </Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Direct Sales Units"
      name="qty7" type="decimal">
      <Expr>NetPriceWithLinkedProds!DIR_12MQty</Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Indirect Sales Units"
      name="qty8" type="decimal">
      <Expr>NetPriceWithLinkedProds!IND_12MQty</Expr>
    </Column>
    <Column DisplayOrderNum="20" DynamicEntryType="CustomColumn" IsInternal="false"
      displayName="Direct Sales $" name="amt1" type="decimal">
      <Expr>NetPriceWithLinkedProds!DIR_12MAmt</Expr>
    </Column>
    <Column DisplayOrderNum="30" DynamicEntryType="CustomColumn" IsInternal="false"
      displayName="Indirect Sales $" name="amt2" type="decimal">
      <Expr>NetPriceWithLinkedProds!IND_12MAmt</Expr>
    </Column>
    <Column DisplayOrderNum="40" DynamicEntryType="CustomColumn" IsInternal="false"
      displayName="Chargebacks $" name="amt3" type="decimal">
      <Expr>NetPriceWithLinkedProds!CHB_12MAmt</Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Occurences" name="dec2"
      type="decimal">
      <Expr> COUNT( NetPriceWithLinkedProds!itemId,
        PARTITION BY
        NetPriceWithLinkedProds!netPrice,
        NetPriceWithLinkedProds!itemId
        ,NetPriceWithLinkedProds!custId,NetPriceWithLinkedProds!contractId,NetPriceWithLinkedProds!period
        ORDER BY
        NetPriceWithLinkedProds!netPrice,
        NetPriceWithLinkedProds!itemId
        ,NetPriceWithLinkedProds!custId,NetPriceWithLinkedProds!contractId,NetPriceWithLinkedProds!period
        ) </Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Rank" name="qty2"
      type="decimal">
      <Expr> DENSE_RANK(
        PARTITION BY
        NetPriceWithLinkedProds!netPrice,
        NetPriceWithLinkedProds!itemId
        ,NetPriceWithLinkedProds!custId,NetPriceWithLinkedProds!contractId,NetPriceWithLinkedProds!period
        ORDER BY
        NetPriceWithLinkedProds!netPrice ASC,
        NetPriceWithLinkedProds!itemId
        ,NetPriceWithLinkedProds!custId,NetPriceWithLinkedProds!contractId,NetPriceWithLinkedProds!period,NetPriceWithLinkedProds!externalLineLinkId
        ) </Expr>
    </Column>
    <Column DynamicEntryType="CustomColumn" IsInternal="false" displayName="Duplicates" name="qty3"
      type="decimal">
      <Expr> ROW_NUMBER(
        PARTITION BY
        NetPriceWithLinkedProds!netPrice,
        NetPriceWithLinkedProds!itemId
        ,NetPriceWithLinkedProds!custId,NetPriceWithLinkedProds!contractId,NetPriceWithLinkedProds!period
        ORDER BY
        NetPriceWithLinkedProds!netPrice ASC,
        NetPriceWithLinkedProds!itemId
        ,NetPriceWithLinkedProds!custId,NetPriceWithLinkedProds!contractId,NetPriceWithLinkedProds!period,NetPriceWithLinkedProds!externalLineLinkId
        ) </Expr>
    </Column>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    description="Quarterly Aggregate of Excluded Net Price Points (Nominal and manually excluded)"
    displayName="Nominal And Excluded Values" drivingWorksheet="NETPP" name="NomExcValues"
    persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="itemid">
      <Dimension name="itemId" />
      <Expr>NETPP!cat_obj_id</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Direct Sales $"
      name="DIR_12MAmt" type="decimal">
      <Expr>SUM(NETPP!amt1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Indirect Sales $"
      name="IND_12MAmt" type="decimal">
      <Expr>SUM(NETPP!amt2)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Chargebacks $"
      name="CHB_12MAmt" type="decimal">
      <Expr>SUM(NETPP!amt3)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Direct Sales Units"
      name="DIR_12MQty" type="decimal">
      <Expr>SUM(NETPP!qty7)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Indirect Sales Units"
      name="IND_12MQty" type="decimal">
      <Expr>SUM(NETPP!qty8)</Expr>
    </Column>
    <GroupingExpression>NETPP!cat_obj_id</GroupingExpression>
    <CalcFilter>or( NETPP!str4="NOMINAL" , NETPP!str4="EXCLUDED" )</CalcFilter>
    <CalcFilter>NETPP!period = [$DisplayableWorkbookQuarterPeriodOffsetsZERO]</CalcFilter>
  </Worksheet>
  <Worksheet CmsUnits="false" DynamicEntryType="CalcWorksheet" IsMaster="false" Offset="0"
    Precision="6" ProductGroup="NONE" Removable="false" UsageType="FORMULA"
    description="12 Month Aggregate of Excluded Net Price Points (Nominal and manually excluded)"
    displayName="12 Month Nominal And Excluded Values" drivingWorksheet="NETPP"
    name="NomExcValues_12M" persisted="false">
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Item ID" name="itemId"
      type="itemid">
      <Dimension name="itemId" />
      <Expr>NETPP!cat_obj_id</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Direct Sales $"
      name="DIR_12MAmt" type="decimal">
      <Expr>SUM(NETPP!amt1)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Indirect Sales $"
      name="IND_12MAmt" type="decimal">
      <Expr>SUM(NETPP!amt2)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Chargebacks $"
      name="CHB_12MAmt" type="decimal">
      <Expr>SUM(NETPP!amt3)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Direct Sales Units"
      name="DIR_12MQty" type="decimal">
      <Expr>SUM(NETPP!qty7)</Expr>
    </Column>
    <Column DynamicEntryType="CalcColumn" IsInternal="false" displayName="Indirect Sales Units"
      name="IND_12MQty" type="decimal">
      <Expr>SUM(NETPP!qty8)</Expr>
    </Column>
    <GroupingExpression>NETPP!cat_obj_id</GroupingExpression>
    <CalcFilter>or( NETPP!str4="NOMINAL" , NETPP!str4="EXCLUDED" )</CalcFilter>
  </Worksheet>
  <NetPriceAlgorithm Name="Direct" NetPriceColumnName="netprice_dir" OrderNum="0"
    WorksheetName="NetPriceCalc">
    <DataSourceInclusion DataSource="DIR_12M" InclusionFlag="INCL" />
  </NetPriceAlgorithm>
  <NetPriceAlgorithm Name="Indirect" NetPriceColumnName="netprice_ind" OrderNum="1"
    WorksheetName="NetPriceCalc">
    <DataSourceInclusion DataSource="DIR_12M" InclusionFlag="EXCL" />
    <DataSourceInclusion DataSource="IND_12M" InclusionFlag="INCL" />
  </NetPriceAlgorithm>
</PriceType>